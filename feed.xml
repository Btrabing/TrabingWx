<?xml version="1.0" encoding="utf-8"?><feed xmlns="http://www.w3.org/2005/Atom" xml:lang="en"><generator uri="https://jekyllrb.com/" version="4.3.4">Jekyll</generator><link href="https://btrabing.github.io/feed.xml" rel="self" type="application/atom+xml"/><link href="https://btrabing.github.io/" rel="alternate" type="text/html" hreflang="en"/><updated>2025-01-08T01:28:46+00:00</updated><id>https://btrabing.github.io/feed.xml</id><title type="html">blank</title><subtitle>Lets discuss the weather. </subtitle><entry><title type="html">End of the 2023 Atlantic Hurricane Season</title><link href="https://btrabing.github.io/blog/2023/end-2023/" rel="alternate" type="text/html" title="End of the 2023 Atlantic Hurricane Season"/><published>2023-12-01T15:59:00+00:00</published><updated>2023-12-01T15:59:00+00:00</updated><id>https://btrabing.github.io/blog/2023/end-2023</id><content type="html" xml:base="https://btrabing.github.io/blog/2023/end-2023/"><![CDATA[<p>Today, the Atlantic hurricane season is finally over. Even though it was an El Nino year, 2023 turned out to be tied for the fourth most active year in terms of the number of named storms.</p> <p>As the 2023 hurricane season concludes, let’s take a straightforward look at two tropical cyclones that defined this year in the Atlantic – Hurricane Idalia and Tropical Storm Ophelia.</p> <h2>Hurricane Idalia: A Category 4 Force </h2> <p>The formation of Idalia from a broad low pressure system in the Caribbean lead to a lot of forecast uncertainty of where Idalia was going to go. However once it formed, the National Hurricane Center forecasters predicted its rapid intensification is it moved into the Gulf of Mexico and along the western coast of Florida. Forecasters faced challenges predicting its exact path, but timely warnings helped communities prepare and evacuate, minimizing potential damage in the Florida Big Bend area. Overall total damage estimates from Hurricane Idalia are in the billions based on information from Moody’s Analytics.</p> <h2>Tropical Storm Ophelia: Do you remember?</h2> <p>Do you remember Tropical Storm Ophelia? It was a short lived tropical system that did not garner as much attention but still had significant impacts along the East Coast. A lot of the tropical cyclones in 2023 were similar to Ophelia in that they were fairly week and often short lived. Only 7 of the 20 named tropical cyclones in 2023 reached hurricane strength. Despite the fact that Ophelia was ‘only’ a tropical storm, it still caused an estimated 450 million in damages (Aon reinsurer).</p> <h2>Takeaways and Looking Forward</h2> <p>Looking ahead, the lessons learned from the 2023 season will contribute to improving hurricane forecasting and response efforts. Collaboration between meteorologists, researchers, and communities is crucial in building resilience against future storms and will now be the focus during the offseason.</p> <p>As we close the 2023 hurricane season, staying vigilant and proactive is key. Together, we can adapt and strengthen our resilience to face the challenges nature throws our way.</p>]]></content><author><name></name></author><category term="2023"/><category term="Discussion"/><category term="Hurricane"/><category term="2023"/><summary type="html"><![CDATA[Notes on the Season]]></summary></entry><entry><title type="html">El Niño and Hurricanes</title><link href="https://btrabing.github.io/blog/2023/enso-2023/" rel="alternate" type="text/html" title="El Niño and Hurricanes"/><published>2023-10-06T12:59:00+00:00</published><updated>2023-10-06T12:59:00+00:00</updated><id>https://btrabing.github.io/blog/2023/enso-2023</id><content type="html" xml:base="https://btrabing.github.io/blog/2023/enso-2023/"><![CDATA[<p>Seasonal forecasts for the 2023 Atlantic hurricane season were below normal as the forecast for the El Niño Southern Oscillation (ENSO) shifted towards an El Niño. Then the forecasts shifted to average or slightly above average as the season began depending on average. So what changed?</p> <p>Over the last few years we have had La Niña conditions. During La Niña equatorial ocean water in the Pacific are cooler than normal. The result tends to be a more active Atlantic hurricane season due to a reduction in vertical wind shear (see 2020). Hurricanes can strengthen quickly when there is no vertical wind shear and all other conditions are favorable.</p> <p>So during an El Niño when the equatorial Pacific sea surface temperature (SST) is above normal, we would expect to see less hurricanes in the Atlantic due to stronger than average vertical wind shear. So why are we expecting more Atlantic hurricanes in 2023 instead of less?</p> <p>The reason is because the sea surface temperature in the Atlantic is hotter than normal over a large area. Hurricanes need warm ocean waters to form, and the hotter the water, the stronger they can get. So the El Niño and warm SST are working against each other and almost balancing out.</p> <p>Since the Atlantic is a large basin, strong vertical wind shear doesn’t always cover the entire basin. Warmer SST over a larger area means that hurricanes can form over a larger area. And this is how we get towards a slightly above average season in the Atlantic.</p> <p>Although ENSO plays a large role in how the Atlantic hurricane season will play out, it is not the only factor. It is also important to remember that regardless of whether it is an active or below-average season, it only takes one hurricane to cause catastrophic damage. Always be prepared.</p>]]></content><author><name></name></author><category term="ENSO"/><category term="Discussion"/><category term="Hurricane"/><category term="2023"/><summary type="html"><![CDATA[Not a normal ENSO]]></summary></entry><entry><title type="html">Plotting SAR Fixes</title><link href="https://btrabing.github.io/blog/2023/sar_fix/" rel="alternate" type="text/html" title="Plotting SAR Fixes"/><published>2023-04-20T19:39:00+00:00</published><updated>2023-04-20T19:39:00+00:00</updated><id>https://btrabing.github.io/blog/2023/sar_fix</id><content type="html" xml:base="https://btrabing.github.io/blog/2023/sar_fix/"><![CDATA[<p>The radius of maximum wind (RMW) is a key strutural parameter of tropical cyclones required to understand the evolution of winds, rainfall, and storm surge. Observations of the RMW are sparse over the ocean, however synthetic aperature radar (SAR) observations have fine enough resolution to observe the RMW in tropical cyclones. The SAR is a c-band radar on polar orbitting satellites, so the RMW is not continously sampled. When an overpass does occur, a fix of the tropical cyclone is added to the f-deck for use by forecasters to estimate the wind structure in real-time. This code below will read in the fix files and save them to <code class="language-plaintext highlighter-rouge">numpy</code> arrays.</p> <h2 id="code">Code</h2> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="n">copy</span>
<span class="kn">import</span> <span class="n">numpy</span> <span class="k">as</span> <span class="n">np</span>
<span class="kn">import</span> <span class="n">datetime</span> <span class="k">as</span> <span class="n">dt</span>
<span class="kn">import</span> <span class="n">subprocess</span>
<span class="kn">import</span> <span class="n">matplotlib.pyplot</span> <span class="k">as</span> <span class="n">plt</span>

<span class="kn">import</span> <span class="n">warnings</span>
<span class="n">warnings</span><span class="p">.</span><span class="nf">filterwarnings</span><span class="p">(</span><span class="sh">"</span><span class="s">ignore</span><span class="sh">"</span><span class="p">)</span>



<span class="k">def</span> <span class="nf">get_fdeck_grep</span><span class="p">(</span><span class="n">OBSTYPE</span><span class="p">,</span><span class="n">STORMPATH</span><span class="p">,</span><span class="n">FIXTYPE</span><span class="o">=</span><span class="sh">''</span><span class="p">):</span>
    <span class="sh">'''</span><span class="s">
    
    Function to get a dataset of f-decks as a ND-numpy array
    
    The formatting of the f-decks can be found here:
          https://www.nrlmry.navy.mil/atcf_web/docs/database/new/newfdeck.txt
    
    Input:
     OBSTYPE          : The observation type to get using grep format for multiple types.
                         i.e. </span><span class="sh">'"</span><span class="s">AIRC\|RDRD</span><span class="sh">"'</span><span class="s"> for aircraft and radar or </span><span class="sh">'</span><span class="s">ASCT</span><span class="sh">'</span><span class="s"> for just ASCAT
     STORMPATH        : Path(s) and filename(s) for all files to grep using wildcard for multiple storms
                         i.e. </span><span class="sh">'</span><span class="s">../dev/fdeck/fal*2019.dat</span><span class="sh">''</span><span class="s">
     FIXTYPE          : Type of fixes to include, such as </span><span class="sh">'</span><span class="s">C</span><span class="sh">'</span><span class="s"> for only center fixes. Flagged fixes will not be
                         output

    Output:
     O_DATE           : Datetime of observation as a string in %Y%m%D%H%M
     O_STID           : Stormid in standard ATCF format
     O_FXFORMAT       : Fix format
     O_FIXTTYPE       : Fix type such as AIRC for aircraft, 
     O_CENTERI        : What was sampled, </span><span class="sh">'</span><span class="s">C</span><span class="sh">'</span><span class="s"> for center fix, </span><span class="sh">'</span><span class="s">R</span><span class="sh">'</span><span class="s"> for wind radii fix
     O_FLAGIND        : Flagged indicator for suspect data, same as CENTERI but with </span><span class="sh">'</span><span class="s">F</span><span class="sh">'</span><span class="s"> for all
     O_FLAT           : Latitude
     O_FLON           : Longitude
     O_HEIGHT         : Height of the observation in meters
     O_POSITCONF      : Position confidence, 1=good, 3=poor
     O_VMAX           : Maximum wind speed in kts
     O_VMAXCONF       : Confidence of VMAX, 1=good, 3=poor
     O_MSLP           : Central Pressure in mb
     O_MSLPCONF       : Confidence in central pressure, 1=good, 3=poor
     O_MSLPDERIV      : Pressure derivation such as </span><span class="sh">'</span><span class="s">DVRK</span><span class="sh">'</span><span class="s"> or </span><span class="sh">'</span><span class="s">MEAS</span><span class="sh">'</span><span class="s"> for measured
     O_WRADII         : Wind radii ID such as 34, 50, or 64
     O_WRNE           : Radius in NE quadrant in n mi
     O_WRSE           : Radius in SE quadrant in n mi
     O_WRSW           : Radius in SW quadrant in n mi
     O_WRNW           : Radius in NW quadrant in n mi
     O_WRNEMODEL      : Radii mode, E=Edge of Pass, C=cut off by land, B=both
     O_WRSEMODEL      : Radii mode, E=Edge of Pass, C=cut off by land, B=both
     O_WRSWMODEL      : Radii mode, E=Edge of Pass, C=cut off by land, B=both
     O_WRNWMODEL      : Radii mode, E=Edge of Pass, C=cut off by land, B=both
     O_WRCONF         : Wind radii confidence, 1=good, 3=poor
     O_RMW            : Radius of maximum winds in n mi
     O_RADEYE         : Diameter of eye in n mi
     A_RMW            : Radius of maximum winds in n mi derived from Aircraft

     
    Example:
     DATE, STID, FXFORMAT, FIXTTYPE, CENTERI, FLAGIND, FLAT, FLON, HEIGHT, POSITCONF, VMAX, VMAXCONF, MSLP, </span><span class="se">\
</span><span class="s">     MSLPCONF, MSLPDERIV, WRADII, WRNE, WRSE, WRSW, WRNW, WRNEMODEL,WRSEMODEL, WRSWMODEL, WRNWMODEL, WRCONF, RMW, </span><span class="se">\
</span><span class="s">     RADEYE, ARMW = get_fdeck_grep(</span><span class="sh">'"</span><span class="s">ASCT\|AMSU\|RDRD</span><span class="sh">"'</span><span class="s"> ,</span><span class="sh">'</span><span class="s">../dev/fdeck/fal092021.dat</span><span class="sh">'</span><span class="s">,FIXTYPE=</span><span class="sh">'</span><span class="s">C</span><span class="sh">'</span><span class="s">)
    
    
    
    </span><span class="sh">'''</span>
    <span class="c1"># First read in the b-deck file
</span>    <span class="n">output</span> <span class="o">=</span> <span class="n">subprocess</span><span class="p">.</span><span class="nf">check_output</span><span class="p">(</span><span class="sh">"</span><span class="s">grep -h </span><span class="sh">"</span><span class="o">+</span><span class="n">OBSTYPE</span><span class="o">+</span><span class="sh">"</span><span class="s"> </span><span class="sh">"</span><span class="o">+</span><span class="n">STORMPATH</span><span class="p">,</span> <span class="n">shell</span><span class="o">=</span><span class="bp">True</span><span class="p">).</span><span class="nf">decode</span><span class="p">().</span><span class="nf">split</span><span class="p">(</span><span class="sh">'</span><span class="se">\n</span><span class="sh">'</span><span class="p">)</span>

    <span class="c1"># Since not all lines have the same number of variables loop through and only keep the first nmax
</span>    <span class="n">new_data</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">nmax</span> <span class="o">=</span> <span class="mi">56</span> <span class="c1"># max number of collumns to read in f-deck
</span>    <span class="n">nout</span> <span class="o">=</span> <span class="mi">28</span> <span class="c1"># number of output variables
</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nf">len</span><span class="p">(</span><span class="n">output</span><span class="p">)):</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">output</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="nf">split</span><span class="p">(</span><span class="sh">'</span><span class="s">,</span><span class="sh">'</span><span class="p">)</span> <span class="c1"># Split the lines by commas
</span>
        <span class="nf">if </span><span class="p">(</span><span class="nf">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">2</span><span class="p">):</span> <span class="c1">#make sure we only use lines with nmax values
</span>
            <span class="c1"># Since older files don't have RMW in the operational best-tracks we need to add data to
</span>            <span class="c1"># to make sure the file sizes are correct
</span>            <span class="k">if</span> <span class="nf">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="o">&lt;</span><span class="n">nmax</span><span class="p">:</span>
                <span class="n">nzeros</span> <span class="o">=</span> <span class="n">nmax</span><span class="o">-</span><span class="nf">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="c1">#number of values to pad the list with
</span>                <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">+</span><span class="p">[</span><span class="sh">'</span><span class="s"> </span><span class="sh">'</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">nzeros</span><span class="p">)]</span> <span class="c1"># Pad the data to get to nmax
</span>
            <span class="n">new_data</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="n">data</span><span class="p">[:</span><span class="n">nmax</span><span class="p">])</span> <span class="c1">#only take the 20 values
</span>
    <span class="n">new_data</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">array</span><span class="p">(</span><span class="n">new_data</span><span class="p">).</span><span class="nf">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span> <span class="c1">#convert back to numpy array
</span>
    <span class="c1"># If no data is found then return missing values
</span>    <span class="k">if</span> <span class="nf">len</span><span class="p">(</span><span class="n">new_data</span><span class="p">)</span><span class="o">&lt;</span><span class="mi">1</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">[</span><span class="o">-</span><span class="mi">999</span><span class="p">]</span><span class="o">*</span><span class="n">nout</span>

    <span class="c1"># Get the number of lines
</span>    <span class="n">nrows</span> <span class="o">=</span> <span class="nf">len</span><span class="p">(</span><span class="n">new_data</span><span class="p">[:,</span><span class="mi">2</span><span class="p">])</span>


    <span class="c1">#Using the unique number of rows, initialize the arrays we will use    
</span>    <span class="n">O_DATE</span>       <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">empty</span><span class="p">((</span><span class="n">nrows</span><span class="p">),</span><span class="n">dtype</span><span class="o">=</span><span class="sh">'</span><span class="s">|U12</span><span class="sh">'</span><span class="p">)</span>
    <span class="n">O_STID</span>       <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">empty</span><span class="p">((</span><span class="n">nrows</span><span class="p">),</span><span class="n">dtype</span><span class="o">=</span><span class="sh">'</span><span class="s">|U8</span><span class="sh">'</span><span class="p">)</span>
    <span class="n">O_FXFORMAT</span>   <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">zeros</span><span class="p">((</span><span class="n">nrows</span><span class="p">))</span>
    <span class="n">O_FIXTTYPE</span>   <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">empty</span><span class="p">((</span><span class="n">nrows</span><span class="p">),</span><span class="n">dtype</span><span class="o">=</span><span class="sh">'</span><span class="s">|U4</span><span class="sh">'</span><span class="p">)</span>
    <span class="n">O_CENTERI</span>    <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">empty</span><span class="p">((</span><span class="n">nrows</span><span class="p">),</span><span class="n">dtype</span><span class="o">=</span><span class="sh">'</span><span class="s">|U10</span><span class="sh">'</span><span class="p">)</span>
    <span class="n">O_FLAGIND</span>    <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">empty</span><span class="p">((</span><span class="n">nrows</span><span class="p">),</span><span class="n">dtype</span><span class="o">=</span><span class="sh">'</span><span class="s">|U1</span><span class="sh">'</span><span class="p">)</span>
    <span class="n">O_VMAX</span>       <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">zeros</span><span class="p">((</span><span class="n">nrows</span><span class="p">))</span>
    <span class="n">O_VMAXCONF</span>   <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">zeros</span><span class="p">((</span><span class="n">nrows</span><span class="p">))</span>
    <span class="n">O_MSLP</span>       <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">zeros</span><span class="p">((</span><span class="n">nrows</span><span class="p">))</span>
    <span class="n">O_MSLPCONF</span>   <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">zeros</span><span class="p">((</span><span class="n">nrows</span><span class="p">))</span>
    <span class="n">O_FLON</span>       <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">zeros</span><span class="p">((</span><span class="n">nrows</span><span class="p">))</span>
    <span class="n">O_FLAT</span>       <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">zeros</span><span class="p">((</span><span class="n">nrows</span><span class="p">))</span>
    <span class="n">O_HEIGHT</span>     <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">zeros</span><span class="p">((</span><span class="n">nrows</span><span class="p">))</span>
    <span class="n">O_POSITCONF</span>  <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">zeros</span><span class="p">((</span><span class="n">nrows</span><span class="p">))</span>
    <span class="n">O_MSLPDERIV</span>  <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">empty</span><span class="p">((</span><span class="n">nrows</span><span class="p">),</span><span class="n">dtype</span><span class="o">=</span><span class="sh">'</span><span class="s">|U4</span><span class="sh">'</span><span class="p">)</span>
    <span class="n">O_WRCODE</span>     <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">zeros</span><span class="p">((</span><span class="n">nrows</span><span class="p">))</span>
    <span class="n">O_WRADII</span>     <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">zeros</span><span class="p">((</span><span class="n">nrows</span><span class="p">))</span>
    <span class="n">O_WRCONF</span>     <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">zeros</span><span class="p">((</span><span class="n">nrows</span><span class="p">))</span>
    <span class="n">O_WRNE</span>       <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">zeros</span><span class="p">((</span><span class="n">nrows</span><span class="p">))</span>
    <span class="n">O_WRSE</span>       <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">zeros</span><span class="p">((</span><span class="n">nrows</span><span class="p">))</span>
    <span class="n">O_WRSW</span>       <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">zeros</span><span class="p">((</span><span class="n">nrows</span><span class="p">))</span>
    <span class="n">O_WRNW</span>       <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">zeros</span><span class="p">((</span><span class="n">nrows</span><span class="p">))</span>
    <span class="n">O_WRNEMODEL</span>  <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">empty</span><span class="p">((</span><span class="n">nrows</span><span class="p">),</span><span class="n">dtype</span><span class="o">=</span><span class="sh">'</span><span class="s">|U1</span><span class="sh">'</span><span class="p">)</span>
    <span class="n">O_WRSEMODEL</span>  <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">empty</span><span class="p">((</span><span class="n">nrows</span><span class="p">),</span><span class="n">dtype</span><span class="o">=</span><span class="sh">'</span><span class="s">|U1</span><span class="sh">'</span><span class="p">)</span>
    <span class="n">O_WRSWMODEL</span>  <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">empty</span><span class="p">((</span><span class="n">nrows</span><span class="p">),</span><span class="n">dtype</span><span class="o">=</span><span class="sh">'</span><span class="s">|U1</span><span class="sh">'</span><span class="p">)</span>
    <span class="n">O_WRNWMODEL</span>  <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">empty</span><span class="p">((</span><span class="n">nrows</span><span class="p">),</span><span class="n">dtype</span><span class="o">=</span><span class="sh">'</span><span class="s">|U1</span><span class="sh">'</span><span class="p">)</span>
    <span class="n">O_RADEYE</span>     <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">zeros</span><span class="p">((</span><span class="n">nrows</span><span class="p">))</span>
    <span class="n">O_RMW</span>        <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">zeros</span><span class="p">((</span><span class="n">nrows</span><span class="p">))</span>
    <span class="n">A_RMW</span>        <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">zeros</span><span class="p">((</span><span class="n">nrows</span><span class="p">))</span>



    <span class="c1"># Now lets loop through and save the data to the specified variables
</span>    <span class="n">i_dat</span> <span class="o">=</span> <span class="mi">0</span>


    <span class="k">for</span> <span class="n">i_dat</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">nrows</span><span class="p">):</span> <span class="c1"># Loop through the unique datetimes
</span>        
        <span class="n">line</span> <span class="o">=</span> <span class="n">new_data</span><span class="p">[</span><span class="n">i_dat</span><span class="p">].</span><span class="nf">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span> <span class="c1">#Get the data for the specific date time
</span>        
        <span class="n">O_DATE</span><span class="p">[</span><span class="n">i_dat</span><span class="p">]</span> <span class="o">=</span> <span class="nf">str</span><span class="p">(</span><span class="nf">int</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">2</span><span class="p">]))</span>

        <span class="c1"># Since each date could have multiple rows for each wind radii, we need to loop through them
</span>        <span class="n">O_STID</span><span class="p">[</span><span class="n">i_dat</span><span class="p">]</span>     <span class="o">=</span> <span class="nf">str</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">]).</span><span class="nf">strip</span><span class="p">()</span><span class="o">+</span><span class="nf">str</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">1</span><span class="p">]).</span><span class="nf">strip</span><span class="p">()</span> <span class="o">+</span> <span class="nf">str</span><span class="p">(</span><span class="nf">int</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">2</span><span class="p">])).</span><span class="nf">strip</span><span class="p">()[:</span><span class="mi">4</span><span class="p">]</span>        
        <span class="n">O_FXFORMAT</span><span class="p">[</span><span class="n">i_dat</span><span class="p">]</span> <span class="o">=</span> <span class="nf">int</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
        <span class="n">O_FIXTTYPE</span><span class="p">[</span><span class="n">i_dat</span><span class="p">]</span> <span class="o">=</span> <span class="n">line</span><span class="p">[</span><span class="mi">4</span><span class="p">].</span><span class="nf">strip</span><span class="p">()</span>
        <span class="n">O_CENTERI</span><span class="p">[</span><span class="n">i_dat</span><span class="p">]</span>  <span class="o">=</span> <span class="n">line</span><span class="p">[</span><span class="mi">5</span><span class="p">].</span><span class="nf">strip</span><span class="p">()</span>
        <span class="n">O_FLAGIND</span><span class="p">[</span><span class="n">i_dat</span><span class="p">]</span>  <span class="o">=</span> <span class="n">line</span><span class="p">[</span><span class="mi">6</span><span class="p">].</span><span class="nf">strip</span><span class="p">()</span>

        <span class="c1"># Convert latitudes to floats
</span>        <span class="k">if</span> <span class="n">line</span><span class="p">[</span><span class="mi">7</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">:]</span><span class="o">==</span><span class="sh">'</span><span class="s">N</span><span class="sh">'</span><span class="p">:</span>
            <span class="n">O_FLAT</span><span class="p">[</span><span class="n">i_dat</span><span class="p">]</span> <span class="o">=</span> <span class="nf">float</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">7</span><span class="p">][:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span><span class="o">/</span><span class="mf">100.</span>
        <span class="k">elif</span> <span class="n">line</span><span class="p">[</span><span class="mi">7</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">:]</span><span class="o">==</span><span class="sh">'</span><span class="s">S</span><span class="sh">'</span><span class="p">:</span>
            <span class="n">O_FLAT</span><span class="p">[</span><span class="n">i_dat</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="nf">float</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">7</span><span class="p">][:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span><span class="o">/</span><span class="mf">100.</span>
        <span class="c1"># Convert longitudes to floats
</span>        <span class="k">if</span> <span class="n">line</span><span class="p">[</span><span class="mi">8</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">:]</span><span class="o">==</span><span class="sh">'</span><span class="s">E</span><span class="sh">'</span><span class="p">:</span>
            <span class="n">O_FLON</span><span class="p">[</span><span class="n">i_dat</span><span class="p">]</span><span class="o">=</span> <span class="nf">float</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">8</span><span class="p">][:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span><span class="o">/</span><span class="mf">100.</span>
        <span class="k">elif</span> <span class="n">line</span><span class="p">[</span><span class="mi">8</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">:]</span><span class="o">==</span><span class="sh">'</span><span class="s">W</span><span class="sh">'</span><span class="p">:</span>
            <span class="n">O_FLON</span><span class="p">[</span><span class="n">i_dat</span><span class="p">]</span><span class="o">=</span> <span class="o">-</span><span class="nf">float</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">8</span><span class="p">][:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span><span class="o">/</span><span class="mf">100.</span>
            
        <span class="n">O_HEIGHT</span><span class="p">[</span><span class="n">i_dat</span><span class="p">]</span>    <span class="o">=</span> <span class="nf">int</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">9</span><span class="p">])</span> <span class="nf">if </span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">9</span><span class="p">].</span><span class="nf">strip</span><span class="p">()</span> <span class="ow">or</span> <span class="bp">None</span><span class="p">)</span> <span class="k">else</span> <span class="n">np</span><span class="p">.</span><span class="n">nan</span>
        <span class="n">O_POSITCONF</span><span class="p">[</span><span class="n">i_dat</span><span class="p">]</span> <span class="o">=</span> <span class="nf">int</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">10</span><span class="p">])</span> <span class="nf">if </span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">10</span><span class="p">].</span><span class="nf">strip</span><span class="p">()</span> <span class="ow">or</span> <span class="bp">None</span><span class="p">)</span> <span class="k">else</span> <span class="n">np</span><span class="p">.</span><span class="n">nan</span>
        <span class="n">O_VMAX</span><span class="p">[</span><span class="n">i_dat</span><span class="p">]</span>      <span class="o">=</span> <span class="nf">int</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">11</span><span class="p">])</span> <span class="nf">if </span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">11</span><span class="p">].</span><span class="nf">strip</span><span class="p">()</span> <span class="ow">or</span> <span class="bp">None</span><span class="p">)</span> <span class="k">else</span> <span class="n">np</span><span class="p">.</span><span class="n">nan</span>
        <span class="n">O_VMAXCONF</span><span class="p">[</span><span class="n">i_dat</span><span class="p">]</span>  <span class="o">=</span> <span class="nf">int</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">12</span><span class="p">])</span> <span class="nf">if </span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">12</span><span class="p">].</span><span class="nf">strip</span><span class="p">()</span> <span class="ow">or</span> <span class="bp">None</span><span class="p">)</span> <span class="k">else</span> <span class="n">np</span><span class="p">.</span><span class="n">nan</span>
        <span class="n">O_MSLP</span><span class="p">[</span><span class="n">i_dat</span><span class="p">]</span>      <span class="o">=</span> <span class="nf">int</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">13</span><span class="p">])</span> <span class="nf">if </span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">13</span><span class="p">].</span><span class="nf">strip</span><span class="p">()</span> <span class="ow">or</span> <span class="bp">None</span><span class="p">)</span> <span class="k">else</span> <span class="n">np</span><span class="p">.</span><span class="n">nan</span>
        <span class="n">O_MSLPCONF</span><span class="p">[</span><span class="n">i_dat</span><span class="p">]</span>  <span class="o">=</span> <span class="nf">int</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">14</span><span class="p">])</span> <span class="nf">if </span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">14</span><span class="p">].</span><span class="nf">strip</span><span class="p">()</span> <span class="ow">or</span> <span class="bp">None</span><span class="p">)</span> <span class="k">else</span> <span class="n">np</span><span class="p">.</span><span class="n">nan</span>
        <span class="n">O_MSLPDERIV</span><span class="p">[</span><span class="n">i_dat</span><span class="p">]</span> <span class="o">=</span> <span class="n">line</span><span class="p">[</span><span class="mi">15</span><span class="p">].</span><span class="nf">strip</span><span class="p">()</span>       

        <span class="c1"># Check if there are wind radii information
</span>        <span class="nf">if </span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">17</span><span class="p">].</span><span class="nf">strip</span><span class="p">()</span><span class="o">==</span><span class="sh">'</span><span class="s">NEQ</span><span class="sh">'</span><span class="p">):</span>

            <span class="n">O_WRADII</span><span class="p">[</span><span class="n">i_dat</span><span class="p">]</span>     <span class="o">=</span> <span class="nf">int</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">16</span><span class="p">])</span>

            <span class="k">if</span> <span class="n">line</span><span class="p">[</span><span class="mi">18</span><span class="p">]</span><span class="o">==</span><span class="sh">'</span><span class="s">*****</span><span class="sh">'</span><span class="p">:</span>
                <span class="n">O_WRNE</span><span class="p">[</span><span class="n">i_dat</span><span class="p">]</span>       <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">nan</span>
            <span class="k">else</span><span class="p">:</span>        
                <span class="n">O_WRNE</span><span class="p">[</span><span class="n">i_dat</span><span class="p">]</span>       <span class="o">=</span> <span class="nf">int</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">18</span><span class="p">])</span>

                
            <span class="k">if</span> <span class="n">line</span><span class="p">[</span><span class="mi">19</span><span class="p">]</span><span class="o">==</span><span class="sh">'</span><span class="s">*****</span><span class="sh">'</span><span class="p">:</span>                
                <span class="n">O_WRSE</span><span class="p">[</span><span class="n">i_dat</span><span class="p">]</span>       <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">nan</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">O_WRSE</span><span class="p">[</span><span class="n">i_dat</span><span class="p">]</span>       <span class="o">=</span> <span class="nf">int</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">19</span><span class="p">])</span>


            <span class="k">if</span> <span class="n">line</span><span class="p">[</span><span class="mi">20</span><span class="p">]</span><span class="o">==</span><span class="sh">'</span><span class="s">*****</span><span class="sh">'</span><span class="p">:</span>
                <span class="n">O_WRSW</span><span class="p">[</span><span class="n">i_dat</span><span class="p">]</span>       <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">nan</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">O_WRSW</span><span class="p">[</span><span class="n">i_dat</span><span class="p">]</span>       <span class="o">=</span> <span class="nf">int</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">20</span><span class="p">])</span>


            <span class="k">if</span> <span class="n">line</span><span class="p">[</span><span class="mi">21</span><span class="p">]</span><span class="o">==</span><span class="sh">'</span><span class="s">*****</span><span class="sh">'</span><span class="p">:</span>
                <span class="n">O_WRNW</span><span class="p">[</span><span class="n">i_dat</span><span class="p">]</span>       <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">nan</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">O_WRNW</span><span class="p">[</span><span class="n">i_dat</span><span class="p">]</span>       <span class="o">=</span> <span class="nf">int</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">21</span><span class="p">])</span>


            <span class="n">O_WRNEMODEL</span><span class="p">[</span><span class="n">i_dat</span><span class="p">]</span>  <span class="o">=</span> <span class="n">line</span><span class="p">[</span><span class="mi">22</span><span class="p">].</span><span class="nf">strip</span><span class="p">()</span>
            <span class="n">O_WRSEMODEL</span><span class="p">[</span><span class="n">i_dat</span><span class="p">]</span>  <span class="o">=</span> <span class="n">line</span><span class="p">[</span><span class="mi">23</span><span class="p">].</span><span class="nf">strip</span><span class="p">()</span>
            <span class="n">O_WRSWMODEL</span><span class="p">[</span><span class="n">i_dat</span><span class="p">]</span>  <span class="o">=</span> <span class="n">line</span><span class="p">[</span><span class="mi">24</span><span class="p">].</span><span class="nf">strip</span><span class="p">()</span>
            <span class="n">O_WRNWMODEL</span><span class="p">[</span><span class="n">i_dat</span><span class="p">]</span>  <span class="o">=</span> <span class="n">line</span><span class="p">[</span><span class="mi">25</span><span class="p">].</span><span class="nf">strip</span><span class="p">()</span>
            <span class="n">O_WRCONF</span><span class="p">[</span><span class="n">i_dat</span><span class="p">]</span>     <span class="o">=</span> <span class="nf">int</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">26</span><span class="p">])</span> <span class="nf">if </span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">26</span><span class="p">].</span><span class="nf">strip</span><span class="p">()</span> <span class="ow">or</span> <span class="bp">None</span><span class="p">)</span> <span class="k">else</span> <span class="n">np</span><span class="p">.</span><span class="n">nan</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># If there are no wind radii information then set to missing values
</span>            <span class="n">O_WRADII</span><span class="p">[</span><span class="n">i_dat</span><span class="p">]</span>     <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">nan</span>
            <span class="n">O_WRNE</span><span class="p">[</span><span class="n">i_dat</span><span class="p">]</span>       <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">nan</span>
            <span class="n">O_WRSE</span><span class="p">[</span><span class="n">i_dat</span><span class="p">]</span>       <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">nan</span>
            <span class="n">O_WRSW</span><span class="p">[</span><span class="n">i_dat</span><span class="p">]</span>       <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">nan</span>
            <span class="n">O_WRNW</span><span class="p">[</span><span class="n">i_dat</span><span class="p">]</span>       <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">nan</span>
            <span class="n">O_WRNEMODEL</span><span class="p">[</span><span class="n">i_dat</span><span class="p">]</span>  <span class="o">=</span> <span class="sh">'</span><span class="s"> </span><span class="sh">'</span>
            <span class="n">O_WRSEMODEL</span><span class="p">[</span><span class="n">i_dat</span><span class="p">]</span>  <span class="o">=</span> <span class="sh">'</span><span class="s"> </span><span class="sh">'</span>
            <span class="n">O_WRSWMODEL</span><span class="p">[</span><span class="n">i_dat</span><span class="p">]</span>  <span class="o">=</span> <span class="sh">'</span><span class="s"> </span><span class="sh">'</span>
            <span class="n">O_WRNWMODEL</span><span class="p">[</span><span class="n">i_dat</span><span class="p">]</span>  <span class="o">=</span> <span class="sh">'</span><span class="s"> </span><span class="sh">'</span>
            <span class="n">O_WRCONF</span><span class="p">[</span><span class="n">i_dat</span><span class="p">]</span>     <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">nan</span>
        


        <span class="n">O_RMW</span><span class="p">[</span><span class="n">i_dat</span><span class="p">]</span>  <span class="o">=</span> <span class="nf">int</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">27</span><span class="p">])</span> <span class="nf">if </span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">27</span><span class="p">].</span><span class="nf">strip</span><span class="p">()</span> <span class="ow">or</span> <span class="bp">None</span><span class="p">)</span> <span class="k">else</span> <span class="n">np</span><span class="p">.</span><span class="n">nan</span>
        <span class="n">O_RADEYE</span><span class="p">[</span><span class="n">i_dat</span><span class="p">]</span>  <span class="o">=</span> <span class="nf">int</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">28</span><span class="p">])</span> <span class="nf">if </span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">28</span><span class="p">].</span><span class="nf">strip</span><span class="p">()</span> <span class="ow">or</span> <span class="bp">None</span><span class="p">)</span> <span class="k">else</span> <span class="n">np</span><span class="p">.</span><span class="n">nan</span>

        <span class="c1"># Only for aircraft
</span>        <span class="k">if</span> <span class="sh">"</span><span class="s">AIRC</span><span class="sh">"</span> <span class="ow">in</span> <span class="n">line</span><span class="p">[</span><span class="mi">4</span><span class="p">].</span><span class="nf">strip</span><span class="p">():</span>
            <span class="n">A_RMW</span><span class="p">[</span><span class="n">i_dat</span><span class="p">]</span>  <span class="o">=</span> <span class="nf">int</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">37</span><span class="p">])</span> <span class="nf">if </span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">37</span><span class="p">].</span><span class="nf">strip</span><span class="p">()</span> <span class="ow">or</span> <span class="bp">None</span><span class="p">)</span> <span class="k">else</span> <span class="n">np</span><span class="p">.</span><span class="n">nan</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">A_RMW</span><span class="p">[</span><span class="n">i_dat</span><span class="p">]</span>  <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">nan</span>
        
    <span class="c1"># Check if we need to apply a fix constraint
</span>    <span class="c1"># If a contraint is applied then we also make sure that that constraint is not flagged as suspect
</span>    <span class="k">if</span> <span class="n">FIXTYPE</span><span class="o">!=</span><span class="sh">''</span><span class="p">:</span>
        <span class="n">cond_fx</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="nf">for </span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span> <span class="ow">in</span> <span class="nf">zip</span><span class="p">(</span><span class="nf">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nf">len</span><span class="p">(</span><span class="n">O_CENTERI</span><span class="p">)),</span><span class="n">O_CENTERI</span><span class="p">,</span><span class="n">O_FLAGIND</span><span class="p">)</span> <span class="nf">if </span><span class="p">(((</span><span class="n">FIXTYPE</span> <span class="ow">or</span> <span class="sh">'</span><span class="s">F</span><span class="sh">'</span><span class="p">)</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">y</span><span class="p">))</span>  <span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">cond_fx</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nf">len</span><span class="p">(</span><span class="n">O_CENTERI</span><span class="p">))]</span>
        

    <span class="k">return</span> <span class="n">O_DATE</span><span class="p">[</span><span class="n">cond_fx</span><span class="p">],</span> <span class="n">O_STID</span><span class="p">[</span><span class="n">cond_fx</span><span class="p">],</span> <span class="n">O_FXFORMAT</span><span class="p">[</span><span class="n">cond_fx</span><span class="p">],</span> <span class="n">O_FIXTTYPE</span><span class="p">[</span><span class="n">cond_fx</span><span class="p">],</span> <span class="n">O_CENTERI</span><span class="p">[</span><span class="n">cond_fx</span><span class="p">],</span> <span class="n">O_FLAGIND</span><span class="p">[</span><span class="n">cond_fx</span><span class="p">],</span> <span class="n">O_FLAT</span><span class="p">[</span><span class="n">cond_fx</span><span class="p">],</span> <span class="n">O_FLON</span><span class="p">[</span><span class="n">cond_fx</span><span class="p">],</span> <span class="n">O_HEIGHT</span><span class="p">[</span><span class="n">cond_fx</span><span class="p">],</span> <span class="n">O_POSITCONF</span><span class="p">[</span><span class="n">cond_fx</span><span class="p">],</span> \
        <span class="n">O_VMAX</span><span class="p">[</span><span class="n">cond_fx</span><span class="p">],</span> <span class="n">O_VMAXCONF</span><span class="p">[</span><span class="n">cond_fx</span><span class="p">],</span> <span class="n">O_MSLP</span><span class="p">[</span><span class="n">cond_fx</span><span class="p">],</span> <span class="n">O_MSLPCONF</span><span class="p">[</span><span class="n">cond_fx</span><span class="p">],</span> <span class="n">O_MSLPDERIV</span><span class="p">[</span><span class="n">cond_fx</span><span class="p">],</span> <span class="n">O_WRADII</span><span class="p">[</span><span class="n">cond_fx</span><span class="p">],</span> <span class="n">O_WRNE</span><span class="p">[</span><span class="n">cond_fx</span><span class="p">],</span> <span class="n">O_WRSE</span><span class="p">[</span><span class="n">cond_fx</span><span class="p">],</span> <span class="n">O_WRSW</span><span class="p">[</span><span class="n">cond_fx</span><span class="p">],</span> <span class="n">O_WRNW</span><span class="p">[</span><span class="n">cond_fx</span><span class="p">],</span> <span class="n">O_WRNEMODEL</span><span class="p">[</span><span class="n">cond_fx</span><span class="p">],</span>\
        <span class="n">O_WRSEMODEL</span><span class="p">[</span><span class="n">cond_fx</span><span class="p">],</span> <span class="n">O_WRSWMODEL</span><span class="p">[</span><span class="n">cond_fx</span><span class="p">],</span> <span class="n">O_WRNWMODEL</span><span class="p">[</span><span class="n">cond_fx</span><span class="p">],</span> <span class="n">O_WRCONF</span><span class="p">[</span><span class="n">cond_fx</span><span class="p">],</span> <span class="n">O_RMW</span><span class="p">[</span><span class="n">cond_fx</span><span class="p">],</span> <span class="n">O_RADEYE</span><span class="p">[</span><span class="n">cond_fx</span><span class="p">],</span><span class="n">A_RMW</span><span class="p">[</span><span class="n">cond_fx</span><span class="p">]</span>



<span class="k">if</span> <span class="n">__name__</span><span class="o">==</span><span class="sh">'</span><span class="s">__main__</span><span class="sh">'</span><span class="p">:</span>

    <span class="n">PATH_TO_FDECK_FILES</span> <span class="o">=</span> <span class="sh">'</span><span class="s">FIX/f*.dat</span><span class="sh">'</span>

    <span class="c1"># Read in the data from the function specifyin the path and the observation type, here we want SAR
</span>    <span class="n">DATE</span><span class="p">,</span> <span class="n">STID</span><span class="p">,</span> <span class="n">FXFORMAT</span><span class="p">,</span> <span class="n">FIXTTYPE</span><span class="p">,</span> <span class="n">CENTERI</span><span class="p">,</span> <span class="n">FLAGIND</span><span class="p">,</span> <span class="n">FLAT</span><span class="p">,</span> <span class="n">FLON</span><span class="p">,</span> <span class="n">HEIGHT</span><span class="p">,</span> <span class="n">POSITCONF</span><span class="p">,</span> <span class="n">VMAX</span><span class="p">,</span> <span class="n">VMAXCONF</span><span class="p">,</span> <span class="n">MSLP</span><span class="p">,</span> \
     <span class="n">MSLPCONF</span><span class="p">,</span> <span class="n">MSLPDERIV</span><span class="p">,</span> <span class="n">WRADII</span><span class="p">,</span> <span class="n">WRNE</span><span class="p">,</span> <span class="n">WRSE</span><span class="p">,</span> <span class="n">WRSW</span><span class="p">,</span> <span class="n">WRNW</span><span class="p">,</span> <span class="n">WRNEMODEL</span><span class="p">,</span><span class="n">WRSEMODEL</span><span class="p">,</span> <span class="n">WRSWMODEL</span><span class="p">,</span> <span class="n">WRNWMODEL</span><span class="p">,</span> <span class="n">WRCONF</span><span class="p">,</span> \
     <span class="n">RMW</span><span class="p">,</span> <span class="n">RADEYE</span><span class="p">,</span> <span class="n">ARMW</span> <span class="o">=</span> <span class="nf">get_fdeck_grep</span><span class="p">(</span><span class="sh">'"</span><span class="s">SAR</span><span class="sh">"'</span> <span class="p">,</span><span class="n">PATH_TO_FDECK_FILES</span><span class="p">)</span>
    
    <span class="c1">#--------------------------------------------------------------
</span>    <span class="c1"># Plot RMW v. Latitude
</span>    <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="p">.</span><span class="nf">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="p">.</span><span class="nf">subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>

    <span class="n">cmap1</span> <span class="o">=</span> <span class="n">copy</span><span class="p">.</span><span class="nf">copy</span><span class="p">(</span><span class="n">plt</span><span class="p">.</span><span class="n">cm</span><span class="p">.</span><span class="n">rainbow</span><span class="p">)</span>

    <span class="n">XVAR</span> <span class="o">=</span> <span class="n">RMW</span><span class="p">[</span><span class="n">WRADII</span><span class="o">==</span><span class="mi">34</span><span class="p">]</span>  <span class="c1"># Don't include duplicates from R50 and R64
</span>    <span class="n">YVAR</span> <span class="o">=</span> <span class="n">FLAT</span><span class="p">[</span><span class="n">WRADII</span><span class="o">==</span><span class="mi">34</span><span class="p">]</span> <span class="c1"># Don't include duplicates from R50 and R64
</span>
    <span class="n">im</span> <span class="o">=</span> <span class="n">ax</span><span class="p">.</span><span class="nf">hexbin</span><span class="p">(</span><span class="n">XVAR</span><span class="p">,</span><span class="n">YVAR</span><span class="p">,</span><span class="n">gridsize</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="p">.</span><span class="mi">9</span><span class="p">,</span><span class="n">linewidths</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">vmin</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">cmap</span><span class="o">=</span><span class="n">cmap1</span><span class="p">)</span>
    <span class="n">im</span><span class="p">.</span><span class="n">cmap</span><span class="p">.</span><span class="nf">set_under</span><span class="p">(</span><span class="sh">'</span><span class="s">w</span><span class="sh">'</span><span class="p">)</span>

    <span class="n">ax</span><span class="p">.</span><span class="nf">scatter</span><span class="p">(</span><span class="n">XVAR</span><span class="p">,</span><span class="n">YVAR</span><span class="p">,</span><span class="n">c</span><span class="o">=</span><span class="sh">'</span><span class="s">k</span><span class="sh">'</span><span class="p">,</span><span class="n">s</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

    <span class="c1"># Limit the boundaries
</span>    <span class="n">ax</span><span class="p">.</span><span class="nf">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">225</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">.</span><span class="nf">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">55</span><span class="p">,</span><span class="mi">55</span><span class="p">)</span>

    <span class="c1"># Add labels
</span>    <span class="n">ax</span><span class="p">.</span><span class="nf">set_title</span><span class="p">(</span><span class="sh">'</span><span class="s">SAR Observations (2016-2023)</span><span class="sh">'</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">.</span><span class="nf">set_xlabel</span><span class="p">(</span><span class="sh">'</span><span class="s">RMW (n mi)</span><span class="sh">'</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">.</span><span class="nf">set_ylabel</span><span class="p">(</span><span class="sh">'</span><span class="s">Latitude (degrees)</span><span class="sh">'</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>

    <span class="c1"># Increase size of xticks
</span>    <span class="n">ax</span><span class="p">.</span><span class="nf">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="sh">'</span><span class="s">y</span><span class="sh">'</span><span class="p">,</span><span class="n">labelsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">.</span><span class="nf">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="sh">'</span><span class="s">x</span><span class="sh">'</span><span class="p">,</span><span class="n">labelsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
    
    <span class="c1"># Remove the top and right lines
</span>    <span class="n">ax</span><span class="p">.</span><span class="n">spines</span><span class="p">[</span><span class="sh">"</span><span class="s">top</span><span class="sh">"</span><span class="p">].</span><span class="nf">set_visible</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">.</span><span class="n">spines</span><span class="p">[</span><span class="sh">"</span><span class="s">right</span><span class="sh">"</span><span class="p">].</span><span class="nf">set_visible</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
    
    <span class="n">cb</span> <span class="o">=</span> <span class="n">plt</span><span class="p">.</span><span class="nf">colorbar</span><span class="p">(</span><span class="n">im</span><span class="p">,</span><span class="n">pad</span><span class="o">=</span><span class="p">.</span><span class="mi">02</span><span class="p">,</span><span class="n">shrink</span><span class="o">=</span><span class="p">.</span><span class="mi">7</span><span class="p">)</span>
    

    <span class="n">plt</span><span class="p">.</span><span class="nf">savefig</span><span class="p">(</span><span class="sh">'</span><span class="s">SAR_RMWvLat_Allbasins.png</span><span class="sh">'</span><span class="p">,</span><span class="n">bbox_inches</span><span class="o">=</span><span class="sh">'</span><span class="s">tight</span><span class="sh">'</span><span class="p">)</span>
    <span class="n">plt</span><span class="p">.</span><span class="nf">show</span><span class="p">()</span>



</code></pre></div></div> <hr/> <p>The code above reads in the fix dataset and can be used to plot SAR data. To illustrate, we can plot the distribution of RMW vs. latitude.</p> <div class="row"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/SAR_RMWvLat_Allbasins-480.webp"/> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/SAR_RMWvLat_Allbasins-800.webp"/> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/SAR_RMWvLat_Allbasins-1400.webp"/> <img src="/assets/img/SAR_RMWvLat_Allbasins.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" title="SAR_RMWvLat" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </div> </div> <div class="caption"> A figure showing latitude vs. RMW for all SAR fixes. </div>]]></content><author><name></name></author><category term="Python"/><category term="plotting"/><category term="SAR"/><summary type="html"><![CDATA[Reading in Tropical Cyclone Fix Dataset and Plotting SAR]]></summary></entry><entry><title type="html">Plotting Discontinuous Data</title><link href="https://btrabing.github.io/blog/2021/plot-discont/" rel="alternate" type="text/html" title="Plotting Discontinuous Data"/><published>2021-12-10T17:39:00+00:00</published><updated>2021-12-10T17:39:00+00:00</updated><id>https://btrabing.github.io/blog/2021/plot-discont</id><content type="html" xml:base="https://btrabing.github.io/blog/2021/plot-discont/"><![CDATA[<p>If you have ever had to make a plot of winds where there is a jump between 270 degrees and 30 degrees, you understand that a line connecting those points looks ugly. I wrote some code to address that issue by adding in <code class="language-plaintext highlighter-rouge">nan</code> values whenever a threshold is met. Take a look at the following code and let me know if you have any questions. Depending on the resolution of the data, you may need to interpolate it to a fine resolution before applying this technique.</p> <h2 id="code">Code</h2> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#!/usr/bin/env python
</span>
<span class="kn">import</span> <span class="n">numpy</span> <span class="k">as</span> <span class="n">np</span>
<span class="kn">from</span> <span class="n">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span> <span class="k">as</span> <span class="n">plt</span>

<span class="k">def</span> <span class="nf">remove_discont</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">):</span>
    <span class="sh">'''</span><span class="s">
    This function will insert nan values when there is a large disconuity in the y data
    
    Requires:
     inport numpy as np
     
    Input:
     x    : array of values on x axis
     y    : array of values on y axis
    
    Set:
     disc_thresh : a tunable threshhold to add nans to
     
    Output:
     x    : new x array with nan values inserted near discrepencies
     y   : new y array with nan values inserted near discrepencies
     
    Use:
     new_x, new_y = remove_discont(x,y)
    
    </span><span class="sh">'''</span>
    
    <span class="c1"># Set disconuity threshhold
</span>    <span class="n">disc_thresh</span> <span class="o">=</span> <span class="mf">330.</span>
    
    <span class="c1"># Calculate the position of the disconuities
</span>    <span class="n">pos</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">where</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="nf">abs</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="nf">diff</span><span class="p">(</span><span class="n">y</span><span class="p">))</span> <span class="o">&gt;=</span> <span class="n">disc_thresh</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span>
    
    <span class="c1"># Insert nan values
</span>    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">insert</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">pos</span><span class="p">,</span><span class="n">np</span><span class="p">.</span><span class="n">nan</span><span class="p">)</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">insert</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">pos</span><span class="p">,</span><span class="n">np</span><span class="p">.</span><span class="n">nan</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">x</span><span class="p">,</span><span class="n">y</span>

<span class="k">if</span> <span class="n">__name__</span><span class="o">==</span><span class="sh">'</span><span class="s">__main__</span><span class="sh">'</span><span class="p">:</span>
    <span class="c1">## Test
</span>
    <span class="c1"># Sample data
</span>    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">50</span><span class="p">)</span>
    <span class="n">y</span> <span class="o">=</span> <span class="mi">180</span><span class="o">*</span><span class="n">np</span><span class="p">.</span><span class="nf">cos</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="n">pi</span><span class="o">*</span><span class="n">np</span><span class="p">.</span><span class="nf">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">50</span><span class="p">))</span><span class="o">+</span><span class="mf">180.</span>

    <span class="n">y</span><span class="p">[</span><span class="mi">26</span><span class="p">:</span><span class="mi">28</span><span class="p">]</span><span class="o">=</span><span class="mi">4</span> <span class="c1"># add disconuity
</span>
    <span class="c1"># Create plot
</span>    <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="p">.</span><span class="nf">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="p">.</span><span class="nf">subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>

    <span class="c1"># Plot test data
</span>    <span class="n">ax</span><span class="p">.</span><span class="nf">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">c</span><span class="o">=</span><span class="sh">'</span><span class="s">k</span><span class="sh">'</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="p">.</span><span class="mi">6</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="sh">'</span><span class="s">Before</span><span class="sh">'</span><span class="p">)</span> <span class="c1"># plot data
</span>
    <span class="c1"># Get new data
</span>    <span class="n">new_x</span><span class="p">,</span> <span class="n">new_y</span> <span class="o">=</span> <span class="nf">remove_discont</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>

    <span class="c1">#Plot new data
</span>    <span class="n">ax</span><span class="p">.</span><span class="nf">plot</span><span class="p">(</span><span class="n">new_x</span><span class="p">,</span><span class="n">new_y</span> <span class="p">,</span><span class="n">c</span><span class="o">=</span><span class="sh">'</span><span class="s">r</span><span class="sh">'</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="n">ls</span><span class="o">=</span><span class="sh">'</span><span class="s">dashed</span><span class="sh">'</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="sh">'</span><span class="s">After</span><span class="sh">'</span><span class="p">)</span>

    <span class="n">ax</span><span class="p">.</span><span class="nf">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">360</span><span class="p">)</span> <span class="c1">#set boundary
</span>
    <span class="n">ax</span><span class="p">.</span><span class="nf">legend</span><span class="p">()</span> <span class="c1">#add legend
</span>
    <span class="n">plt</span><span class="p">.</span><span class="nf">savefig</span><span class="p">(</span><span class="sh">'</span><span class="s">Discontinuity.png</span><span class="sh">'</span><span class="p">,</span><span class="n">bbox_inches</span><span class="o">=</span><span class="sh">'</span><span class="s">tight</span><span class="sh">'</span><span class="p">)</span>
    <span class="n">plt</span><span class="p">.</span><span class="nf">show</span><span class="p">()</span>



</code></pre></div></div> <hr/> <p>The red line generated from <code class="language-plaintext highlighter-rouge">remove_discont()</code> is much much cleaner.</p> <div class="row"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/Discontinuity-480.webp"/> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/Discontinuity-800.webp"/> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/Discontinuity-1400.webp"/> <img src="/assets/img/Discontinuity.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" title="Discontinuity" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </div> </div> <div class="caption"> A before and after of the line plots after using the discontinuity function. </div>]]></content><author><name></name></author><category term="Python"/><category term="plotting"/><summary type="html"><![CDATA[How to remove extra lines from discontinuous data points]]></summary></entry><entry><title type="html">Plotting with Python</title><link href="https://btrabing.github.io/blog/2018/contour/" rel="alternate" type="text/html" title="Plotting with Python"/><published>2018-09-20T17:39:00+00:00</published><updated>2018-09-20T17:39:00+00:00</updated><id>https://btrabing.github.io/blog/2018/contour</id><content type="html" xml:base="https://btrabing.github.io/blog/2018/contour/"><![CDATA[<p>A how to example for plotting contours in the form of a jupyter notebook that has been converted to html.</p>]]></content><author><name></name></author><category term="Python"/><category term="Matplotlib"/><category term="Example"/><summary type="html"><![CDATA[A how to example for plotting contours]]></summary></entry><entry><title type="html">Indexing with Numpy</title><link href="https://btrabing.github.io/blog/2018/index/" rel="alternate" type="text/html" title="Indexing with Numpy"/><published>2018-09-10T17:39:00+00:00</published><updated>2018-09-10T17:39:00+00:00</updated><id>https://btrabing.github.io/blog/2018/index</id><content type="html" xml:base="https://btrabing.github.io/blog/2018/index/"><![CDATA[<p>A how to example for using indexing to manipulate arrays in python. This is a jupyter notebook that has been converted to html.</p>]]></content><author><name></name></author><category term="Python"/><category term="Numpy"/><category term="Example"/><summary type="html"><![CDATA[A how to example for using numpy indexing]]></summary></entry></feed>