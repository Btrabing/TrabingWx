<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title>Plotting SAR Fixes | Benjamin Trabing</title> <meta name="author" content="Benjamin Trabing"> <meta name="description" content="Reading in Tropical Cyclone Fix Dataset and Plotting SAR"> <meta name="keywords" content="jekyll, jekyll-theme, academic-website, tropical-cyclones"> <link rel="stylesheet" href="/TrabingWx/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="https://unpkg.com/bootstrap-table@1.22.1/dist/bootstrap-table.min.css"> <link rel="stylesheet" href="/TrabingWx/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons"> <link rel="stylesheet" href="/TrabingWx/assets/css/jekyll-pygments-themes-github.css?19f3075a2d19613090fe9e16b564e1fe" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20100%20100%22&gt;&lt;text%20y=%22.9em%22%20font-size=%2290%22&gt;%E2%9A%9B%EF%B8%8F&lt;/text&gt;&lt;/svg&gt;"> <link rel="stylesheet" href="/TrabingWx/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://btrabing.github.io/TrabingWx/blog/2023/sar_fix/"> <link rel="stylesheet" href="/TrabingWx/assets/css/jekyll-pygments-themes-native.css?e74e74bf055e5729d44a7d031a5ca6a5" media="none" id="highlight_theme_dark"> <script src="/TrabingWx/assets/js/theme.js?96d6b3e1c3604aca8b6134c7afdd5db6"></script> <script src="/TrabingWx/assets/js/dark_mode.js?9b17307bb950ffa2e34be0227f53558f"></script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/TrabingWx/"><span class="font-weight-bold">Benjamin </span>Trabing</a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/TrabingWx/">About</a> </li> <li class="nav-item active"> <a class="nav-link" href="/TrabingWx/blog/">Blog<span class="sr-only">(current)</span></a> </li> <li class="nav-item "> <a class="nav-link" href="/TrabingWx/publications/">Publications</a> </li> <li class="nav-item "> <a class="nav-link" href="/TrabingWx/projects/">Projects</a> </li> <li class="nav-item "> <a class="nav-link" href="/TrabingWx/cv/">CV</a> </li> <li class="nav-item "> <a class="nav-link" href="/TrabingWx/teaching/">Teaching</a> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="fas fa-moon"></i> <i class="fas fa-sun"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5"> <div class="post"> <header class="post-header"> <h1 class="post-title">Plotting SAR Fixes</h1> <p class="post-meta">April 20, 2023</p> <p class="post-tags"> <a href="/TrabingWx/blog/2023"> <i class="fas fa-calendar fa-sm"></i> 2023 </a>   ·   <a href="/TrabingWx/blog/tag/python"> <i class="fas fa-hashtag fa-sm"></i> Python</a>   <a href="/TrabingWx/blog/tag/plotting"> <i class="fas fa-hashtag fa-sm"></i> plotting</a>   <a href="/TrabingWx/blog/tag/sar"> <i class="fas fa-hashtag fa-sm"></i> SAR</a>   </p> </header> <article class="post-content"> <div id="markdown-content"> <p>The radius of maximum wind (RMW) is a key strutural parameter of tropical cyclones required to understand the evolution of winds, rainfall, and storm surge. Observations of the RMW are sparse over the ocean, however synthetic aperature radar (SAR) observations have fine enough resolution to observe the RMW in tropical cyclones. The SAR is a c-band radar on polar orbitting satellites, so the RMW is not continously sampled. When an overpass does occur, a fix of the tropical cyclone is added to the f-deck for use by forecasters to estimate the wind structure in real-time. This code below will read in the fix files and save them to <code class="language-plaintext highlighter-rouge">numpy</code> arrays.</p> <h2 id="code">Code</h2> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="n">copy</span>
<span class="kn">import</span> <span class="n">numpy</span> <span class="k">as</span> <span class="n">np</span>
<span class="kn">import</span> <span class="n">datetime</span> <span class="k">as</span> <span class="n">dt</span>
<span class="kn">import</span> <span class="n">subprocess</span>
<span class="kn">import</span> <span class="n">matplotlib.pyplot</span> <span class="k">as</span> <span class="n">plt</span>

<span class="kn">import</span> <span class="n">warnings</span>
<span class="n">warnings</span><span class="p">.</span><span class="nf">filterwarnings</span><span class="p">(</span><span class="sh">"</span><span class="s">ignore</span><span class="sh">"</span><span class="p">)</span>



<span class="k">def</span> <span class="nf">get_fdeck_grep</span><span class="p">(</span><span class="n">OBSTYPE</span><span class="p">,</span><span class="n">STORMPATH</span><span class="p">,</span><span class="n">FIXTYPE</span><span class="o">=</span><span class="sh">''</span><span class="p">):</span>
    <span class="sh">'''</span><span class="s">
    
    Function to get a dataset of f-decks as a ND-numpy array
    
    The formatting of the f-decks can be found here:
          https://www.nrlmry.navy.mil/atcf_web/docs/database/new/newfdeck.txt
    
    Input:
     OBSTYPE          : The observation type to get using grep format for multiple types.
                         i.e. </span><span class="sh">'"</span><span class="s">AIRC\|RDRD</span><span class="sh">"'</span><span class="s"> for aircraft and radar or </span><span class="sh">'</span><span class="s">ASCT</span><span class="sh">'</span><span class="s"> for just ASCAT
     STORMPATH        : Path(s) and filename(s) for all files to grep using wildcard for multiple storms
                         i.e. </span><span class="sh">'</span><span class="s">../dev/fdeck/fal*2019.dat</span><span class="sh">''</span><span class="s">
     FIXTYPE          : Type of fixes to include, such as </span><span class="sh">'</span><span class="s">C</span><span class="sh">'</span><span class="s"> for only center fixes. Flagged fixes will not be
                         output

    Output:
     O_DATE           : Datetime of observation as a string in %Y%m%D%H%M
     O_STID           : Stormid in standard ATCF format
     O_FXFORMAT       : Fix format
     O_FIXTTYPE       : Fix type such as AIRC for aircraft, 
     O_CENTERI        : What was sampled, </span><span class="sh">'</span><span class="s">C</span><span class="sh">'</span><span class="s"> for center fix, </span><span class="sh">'</span><span class="s">R</span><span class="sh">'</span><span class="s"> for wind radii fix
     O_FLAGIND        : Flagged indicator for suspect data, same as CENTERI but with </span><span class="sh">'</span><span class="s">F</span><span class="sh">'</span><span class="s"> for all
     O_FLAT           : Latitude
     O_FLON           : Longitude
     O_HEIGHT         : Height of the observation in meters
     O_POSITCONF      : Position confidence, 1=good, 3=poor
     O_VMAX           : Maximum wind speed in kts
     O_VMAXCONF       : Confidence of VMAX, 1=good, 3=poor
     O_MSLP           : Central Pressure in mb
     O_MSLPCONF       : Confidence in central pressure, 1=good, 3=poor
     O_MSLPDERIV      : Pressure derivation such as </span><span class="sh">'</span><span class="s">DVRK</span><span class="sh">'</span><span class="s"> or </span><span class="sh">'</span><span class="s">MEAS</span><span class="sh">'</span><span class="s"> for measured
     O_WRADII         : Wind radii ID such as 34, 50, or 64
     O_WRNE           : Radius in NE quadrant in n mi
     O_WRSE           : Radius in SE quadrant in n mi
     O_WRSW           : Radius in SW quadrant in n mi
     O_WRNW           : Radius in NW quadrant in n mi
     O_WRNEMODEL      : Radii mode, E=Edge of Pass, C=cut off by land, B=both
     O_WRSEMODEL      : Radii mode, E=Edge of Pass, C=cut off by land, B=both
     O_WRSWMODEL      : Radii mode, E=Edge of Pass, C=cut off by land, B=both
     O_WRNWMODEL      : Radii mode, E=Edge of Pass, C=cut off by land, B=both
     O_WRCONF         : Wind radii confidence, 1=good, 3=poor
     O_RMW            : Radius of maximum winds in n mi
     O_RADEYE         : Diameter of eye in n mi
     A_RMW            : Radius of maximum winds in n mi derived from Aircraft

     
    Example:
     DATE, STID, FXFORMAT, FIXTTYPE, CENTERI, FLAGIND, FLAT, FLON, HEIGHT, POSITCONF, VMAX, VMAXCONF, MSLP, </span><span class="se">\
</span><span class="s">     MSLPCONF, MSLPDERIV, WRADII, WRNE, WRSE, WRSW, WRNW, WRNEMODEL,WRSEMODEL, WRSWMODEL, WRNWMODEL, WRCONF, RMW, </span><span class="se">\
</span><span class="s">     RADEYE, ARMW = get_fdeck_grep(</span><span class="sh">'"</span><span class="s">ASCT\|AMSU\|RDRD</span><span class="sh">"'</span><span class="s"> ,</span><span class="sh">'</span><span class="s">../dev/fdeck/fal092021.dat</span><span class="sh">'</span><span class="s">,FIXTYPE=</span><span class="sh">'</span><span class="s">C</span><span class="sh">'</span><span class="s">)
    
    
    
    </span><span class="sh">'''</span>
    <span class="c1"># First read in the b-deck file
</span>    <span class="n">output</span> <span class="o">=</span> <span class="n">subprocess</span><span class="p">.</span><span class="nf">check_output</span><span class="p">(</span><span class="sh">"</span><span class="s">grep -h </span><span class="sh">"</span><span class="o">+</span><span class="n">OBSTYPE</span><span class="o">+</span><span class="sh">"</span><span class="s"> </span><span class="sh">"</span><span class="o">+</span><span class="n">STORMPATH</span><span class="p">,</span> <span class="n">shell</span><span class="o">=</span><span class="bp">True</span><span class="p">).</span><span class="nf">decode</span><span class="p">().</span><span class="nf">split</span><span class="p">(</span><span class="sh">'</span><span class="se">\n</span><span class="sh">'</span><span class="p">)</span>

    <span class="c1"># Since not all lines have the same number of variables loop through and only keep the first nmax
</span>    <span class="n">new_data</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">nmax</span> <span class="o">=</span> <span class="mi">56</span> <span class="c1"># max number of collumns to read in f-deck
</span>    <span class="n">nout</span> <span class="o">=</span> <span class="mi">28</span> <span class="c1"># number of output variables
</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nf">len</span><span class="p">(</span><span class="n">output</span><span class="p">)):</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">output</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="nf">split</span><span class="p">(</span><span class="sh">'</span><span class="s">,</span><span class="sh">'</span><span class="p">)</span> <span class="c1"># Split the lines by commas
</span>
        <span class="nf">if </span><span class="p">(</span><span class="nf">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">2</span><span class="p">):</span> <span class="c1">#make sure we only use lines with nmax values
</span>
            <span class="c1"># Since older files don't have RMW in the operational best-tracks we need to add data to
</span>            <span class="c1"># to make sure the file sizes are correct
</span>            <span class="k">if</span> <span class="nf">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="o">&lt;</span><span class="n">nmax</span><span class="p">:</span>
                <span class="n">nzeros</span> <span class="o">=</span> <span class="n">nmax</span><span class="o">-</span><span class="nf">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="c1">#number of values to pad the list with
</span>                <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">+</span><span class="p">[</span><span class="sh">'</span><span class="s"> </span><span class="sh">'</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">nzeros</span><span class="p">)]</span> <span class="c1"># Pad the data to get to nmax
</span>
            <span class="n">new_data</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="n">data</span><span class="p">[:</span><span class="n">nmax</span><span class="p">])</span> <span class="c1">#only take the 20 values
</span>
    <span class="n">new_data</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">array</span><span class="p">(</span><span class="n">new_data</span><span class="p">).</span><span class="nf">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span> <span class="c1">#convert back to numpy array
</span>
    <span class="c1"># If no data is found then return missing values
</span>    <span class="k">if</span> <span class="nf">len</span><span class="p">(</span><span class="n">new_data</span><span class="p">)</span><span class="o">&lt;</span><span class="mi">1</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">[</span><span class="o">-</span><span class="mi">999</span><span class="p">]</span><span class="o">*</span><span class="n">nout</span>

    <span class="c1"># Get the number of lines
</span>    <span class="n">nrows</span> <span class="o">=</span> <span class="nf">len</span><span class="p">(</span><span class="n">new_data</span><span class="p">[:,</span><span class="mi">2</span><span class="p">])</span>


    <span class="c1">#Using the unique number of rows, initialize the arrays we will use    
</span>    <span class="n">O_DATE</span>       <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">empty</span><span class="p">((</span><span class="n">nrows</span><span class="p">),</span><span class="n">dtype</span><span class="o">=</span><span class="sh">'</span><span class="s">|U12</span><span class="sh">'</span><span class="p">)</span>
    <span class="n">O_STID</span>       <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">empty</span><span class="p">((</span><span class="n">nrows</span><span class="p">),</span><span class="n">dtype</span><span class="o">=</span><span class="sh">'</span><span class="s">|U8</span><span class="sh">'</span><span class="p">)</span>
    <span class="n">O_FXFORMAT</span>   <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">zeros</span><span class="p">((</span><span class="n">nrows</span><span class="p">))</span>
    <span class="n">O_FIXTTYPE</span>   <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">empty</span><span class="p">((</span><span class="n">nrows</span><span class="p">),</span><span class="n">dtype</span><span class="o">=</span><span class="sh">'</span><span class="s">|U4</span><span class="sh">'</span><span class="p">)</span>
    <span class="n">O_CENTERI</span>    <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">empty</span><span class="p">((</span><span class="n">nrows</span><span class="p">),</span><span class="n">dtype</span><span class="o">=</span><span class="sh">'</span><span class="s">|U10</span><span class="sh">'</span><span class="p">)</span>
    <span class="n">O_FLAGIND</span>    <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">empty</span><span class="p">((</span><span class="n">nrows</span><span class="p">),</span><span class="n">dtype</span><span class="o">=</span><span class="sh">'</span><span class="s">|U1</span><span class="sh">'</span><span class="p">)</span>
    <span class="n">O_VMAX</span>       <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">zeros</span><span class="p">((</span><span class="n">nrows</span><span class="p">))</span>
    <span class="n">O_VMAXCONF</span>   <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">zeros</span><span class="p">((</span><span class="n">nrows</span><span class="p">))</span>
    <span class="n">O_MSLP</span>       <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">zeros</span><span class="p">((</span><span class="n">nrows</span><span class="p">))</span>
    <span class="n">O_MSLPCONF</span>   <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">zeros</span><span class="p">((</span><span class="n">nrows</span><span class="p">))</span>
    <span class="n">O_FLON</span>       <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">zeros</span><span class="p">((</span><span class="n">nrows</span><span class="p">))</span>
    <span class="n">O_FLAT</span>       <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">zeros</span><span class="p">((</span><span class="n">nrows</span><span class="p">))</span>
    <span class="n">O_HEIGHT</span>     <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">zeros</span><span class="p">((</span><span class="n">nrows</span><span class="p">))</span>
    <span class="n">O_POSITCONF</span>  <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">zeros</span><span class="p">((</span><span class="n">nrows</span><span class="p">))</span>
    <span class="n">O_MSLPDERIV</span>  <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">empty</span><span class="p">((</span><span class="n">nrows</span><span class="p">),</span><span class="n">dtype</span><span class="o">=</span><span class="sh">'</span><span class="s">|U4</span><span class="sh">'</span><span class="p">)</span>
    <span class="n">O_WRCODE</span>     <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">zeros</span><span class="p">((</span><span class="n">nrows</span><span class="p">))</span>
    <span class="n">O_WRADII</span>     <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">zeros</span><span class="p">((</span><span class="n">nrows</span><span class="p">))</span>
    <span class="n">O_WRCONF</span>     <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">zeros</span><span class="p">((</span><span class="n">nrows</span><span class="p">))</span>
    <span class="n">O_WRNE</span>       <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">zeros</span><span class="p">((</span><span class="n">nrows</span><span class="p">))</span>
    <span class="n">O_WRSE</span>       <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">zeros</span><span class="p">((</span><span class="n">nrows</span><span class="p">))</span>
    <span class="n">O_WRSW</span>       <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">zeros</span><span class="p">((</span><span class="n">nrows</span><span class="p">))</span>
    <span class="n">O_WRNW</span>       <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">zeros</span><span class="p">((</span><span class="n">nrows</span><span class="p">))</span>
    <span class="n">O_WRNEMODEL</span>  <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">empty</span><span class="p">((</span><span class="n">nrows</span><span class="p">),</span><span class="n">dtype</span><span class="o">=</span><span class="sh">'</span><span class="s">|U1</span><span class="sh">'</span><span class="p">)</span>
    <span class="n">O_WRSEMODEL</span>  <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">empty</span><span class="p">((</span><span class="n">nrows</span><span class="p">),</span><span class="n">dtype</span><span class="o">=</span><span class="sh">'</span><span class="s">|U1</span><span class="sh">'</span><span class="p">)</span>
    <span class="n">O_WRSWMODEL</span>  <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">empty</span><span class="p">((</span><span class="n">nrows</span><span class="p">),</span><span class="n">dtype</span><span class="o">=</span><span class="sh">'</span><span class="s">|U1</span><span class="sh">'</span><span class="p">)</span>
    <span class="n">O_WRNWMODEL</span>  <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">empty</span><span class="p">((</span><span class="n">nrows</span><span class="p">),</span><span class="n">dtype</span><span class="o">=</span><span class="sh">'</span><span class="s">|U1</span><span class="sh">'</span><span class="p">)</span>
    <span class="n">O_RADEYE</span>     <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">zeros</span><span class="p">((</span><span class="n">nrows</span><span class="p">))</span>
    <span class="n">O_RMW</span>        <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">zeros</span><span class="p">((</span><span class="n">nrows</span><span class="p">))</span>
    <span class="n">A_RMW</span>        <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">zeros</span><span class="p">((</span><span class="n">nrows</span><span class="p">))</span>



    <span class="c1"># Now lets loop through and save the data to the specified variables
</span>    <span class="n">i_dat</span> <span class="o">=</span> <span class="mi">0</span>


    <span class="k">for</span> <span class="n">i_dat</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">nrows</span><span class="p">):</span> <span class="c1"># Loop through the unique datetimes
</span>        
        <span class="n">line</span> <span class="o">=</span> <span class="n">new_data</span><span class="p">[</span><span class="n">i_dat</span><span class="p">].</span><span class="nf">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span> <span class="c1">#Get the data for the specific date time
</span>        
        <span class="n">O_DATE</span><span class="p">[</span><span class="n">i_dat</span><span class="p">]</span> <span class="o">=</span> <span class="nf">str</span><span class="p">(</span><span class="nf">int</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">2</span><span class="p">]))</span>

        <span class="c1"># Since each date could have multiple rows for each wind radii, we need to loop through them
</span>        <span class="n">O_STID</span><span class="p">[</span><span class="n">i_dat</span><span class="p">]</span>     <span class="o">=</span> <span class="nf">str</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">]).</span><span class="nf">strip</span><span class="p">()</span><span class="o">+</span><span class="nf">str</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">1</span><span class="p">]).</span><span class="nf">strip</span><span class="p">()</span> <span class="o">+</span> <span class="nf">str</span><span class="p">(</span><span class="nf">int</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">2</span><span class="p">])).</span><span class="nf">strip</span><span class="p">()[:</span><span class="mi">4</span><span class="p">]</span>        
        <span class="n">O_FXFORMAT</span><span class="p">[</span><span class="n">i_dat</span><span class="p">]</span> <span class="o">=</span> <span class="nf">int</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
        <span class="n">O_FIXTTYPE</span><span class="p">[</span><span class="n">i_dat</span><span class="p">]</span> <span class="o">=</span> <span class="n">line</span><span class="p">[</span><span class="mi">4</span><span class="p">].</span><span class="nf">strip</span><span class="p">()</span>
        <span class="n">O_CENTERI</span><span class="p">[</span><span class="n">i_dat</span><span class="p">]</span>  <span class="o">=</span> <span class="n">line</span><span class="p">[</span><span class="mi">5</span><span class="p">].</span><span class="nf">strip</span><span class="p">()</span>
        <span class="n">O_FLAGIND</span><span class="p">[</span><span class="n">i_dat</span><span class="p">]</span>  <span class="o">=</span> <span class="n">line</span><span class="p">[</span><span class="mi">6</span><span class="p">].</span><span class="nf">strip</span><span class="p">()</span>

        <span class="c1"># Convert latitudes to floats
</span>        <span class="k">if</span> <span class="n">line</span><span class="p">[</span><span class="mi">7</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">:]</span><span class="o">==</span><span class="sh">'</span><span class="s">N</span><span class="sh">'</span><span class="p">:</span>
            <span class="n">O_FLAT</span><span class="p">[</span><span class="n">i_dat</span><span class="p">]</span> <span class="o">=</span> <span class="nf">float</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">7</span><span class="p">][:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span><span class="o">/</span><span class="mf">100.</span>
        <span class="k">elif</span> <span class="n">line</span><span class="p">[</span><span class="mi">7</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">:]</span><span class="o">==</span><span class="sh">'</span><span class="s">S</span><span class="sh">'</span><span class="p">:</span>
            <span class="n">O_FLAT</span><span class="p">[</span><span class="n">i_dat</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="nf">float</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">7</span><span class="p">][:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span><span class="o">/</span><span class="mf">100.</span>
        <span class="c1"># Convert longitudes to floats
</span>        <span class="k">if</span> <span class="n">line</span><span class="p">[</span><span class="mi">8</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">:]</span><span class="o">==</span><span class="sh">'</span><span class="s">E</span><span class="sh">'</span><span class="p">:</span>
            <span class="n">O_FLON</span><span class="p">[</span><span class="n">i_dat</span><span class="p">]</span><span class="o">=</span> <span class="nf">float</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">8</span><span class="p">][:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span><span class="o">/</span><span class="mf">100.</span>
        <span class="k">elif</span> <span class="n">line</span><span class="p">[</span><span class="mi">8</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">:]</span><span class="o">==</span><span class="sh">'</span><span class="s">W</span><span class="sh">'</span><span class="p">:</span>
            <span class="n">O_FLON</span><span class="p">[</span><span class="n">i_dat</span><span class="p">]</span><span class="o">=</span> <span class="o">-</span><span class="nf">float</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">8</span><span class="p">][:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span><span class="o">/</span><span class="mf">100.</span>
            
        <span class="n">O_HEIGHT</span><span class="p">[</span><span class="n">i_dat</span><span class="p">]</span>    <span class="o">=</span> <span class="nf">int</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">9</span><span class="p">])</span> <span class="nf">if </span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">9</span><span class="p">].</span><span class="nf">strip</span><span class="p">()</span> <span class="ow">or</span> <span class="bp">None</span><span class="p">)</span> <span class="k">else</span> <span class="n">np</span><span class="p">.</span><span class="n">nan</span>
        <span class="n">O_POSITCONF</span><span class="p">[</span><span class="n">i_dat</span><span class="p">]</span> <span class="o">=</span> <span class="nf">int</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">10</span><span class="p">])</span> <span class="nf">if </span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">10</span><span class="p">].</span><span class="nf">strip</span><span class="p">()</span> <span class="ow">or</span> <span class="bp">None</span><span class="p">)</span> <span class="k">else</span> <span class="n">np</span><span class="p">.</span><span class="n">nan</span>
        <span class="n">O_VMAX</span><span class="p">[</span><span class="n">i_dat</span><span class="p">]</span>      <span class="o">=</span> <span class="nf">int</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">11</span><span class="p">])</span> <span class="nf">if </span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">11</span><span class="p">].</span><span class="nf">strip</span><span class="p">()</span> <span class="ow">or</span> <span class="bp">None</span><span class="p">)</span> <span class="k">else</span> <span class="n">np</span><span class="p">.</span><span class="n">nan</span>
        <span class="n">O_VMAXCONF</span><span class="p">[</span><span class="n">i_dat</span><span class="p">]</span>  <span class="o">=</span> <span class="nf">int</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">12</span><span class="p">])</span> <span class="nf">if </span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">12</span><span class="p">].</span><span class="nf">strip</span><span class="p">()</span> <span class="ow">or</span> <span class="bp">None</span><span class="p">)</span> <span class="k">else</span> <span class="n">np</span><span class="p">.</span><span class="n">nan</span>
        <span class="n">O_MSLP</span><span class="p">[</span><span class="n">i_dat</span><span class="p">]</span>      <span class="o">=</span> <span class="nf">int</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">13</span><span class="p">])</span> <span class="nf">if </span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">13</span><span class="p">].</span><span class="nf">strip</span><span class="p">()</span> <span class="ow">or</span> <span class="bp">None</span><span class="p">)</span> <span class="k">else</span> <span class="n">np</span><span class="p">.</span><span class="n">nan</span>
        <span class="n">O_MSLPCONF</span><span class="p">[</span><span class="n">i_dat</span><span class="p">]</span>  <span class="o">=</span> <span class="nf">int</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">14</span><span class="p">])</span> <span class="nf">if </span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">14</span><span class="p">].</span><span class="nf">strip</span><span class="p">()</span> <span class="ow">or</span> <span class="bp">None</span><span class="p">)</span> <span class="k">else</span> <span class="n">np</span><span class="p">.</span><span class="n">nan</span>
        <span class="n">O_MSLPDERIV</span><span class="p">[</span><span class="n">i_dat</span><span class="p">]</span> <span class="o">=</span> <span class="n">line</span><span class="p">[</span><span class="mi">15</span><span class="p">].</span><span class="nf">strip</span><span class="p">()</span>       

        <span class="c1"># Check if there are wind radii information
</span>        <span class="nf">if </span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">17</span><span class="p">].</span><span class="nf">strip</span><span class="p">()</span><span class="o">==</span><span class="sh">'</span><span class="s">NEQ</span><span class="sh">'</span><span class="p">):</span>

            <span class="n">O_WRADII</span><span class="p">[</span><span class="n">i_dat</span><span class="p">]</span>     <span class="o">=</span> <span class="nf">int</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">16</span><span class="p">])</span>

            <span class="k">if</span> <span class="n">line</span><span class="p">[</span><span class="mi">18</span><span class="p">]</span><span class="o">==</span><span class="sh">'</span><span class="s">*****</span><span class="sh">'</span><span class="p">:</span>
                <span class="n">O_WRNE</span><span class="p">[</span><span class="n">i_dat</span><span class="p">]</span>       <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">nan</span>
            <span class="k">else</span><span class="p">:</span>        
                <span class="n">O_WRNE</span><span class="p">[</span><span class="n">i_dat</span><span class="p">]</span>       <span class="o">=</span> <span class="nf">int</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">18</span><span class="p">])</span>

                
            <span class="k">if</span> <span class="n">line</span><span class="p">[</span><span class="mi">19</span><span class="p">]</span><span class="o">==</span><span class="sh">'</span><span class="s">*****</span><span class="sh">'</span><span class="p">:</span>                
                <span class="n">O_WRSE</span><span class="p">[</span><span class="n">i_dat</span><span class="p">]</span>       <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">nan</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">O_WRSE</span><span class="p">[</span><span class="n">i_dat</span><span class="p">]</span>       <span class="o">=</span> <span class="nf">int</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">19</span><span class="p">])</span>


            <span class="k">if</span> <span class="n">line</span><span class="p">[</span><span class="mi">20</span><span class="p">]</span><span class="o">==</span><span class="sh">'</span><span class="s">*****</span><span class="sh">'</span><span class="p">:</span>
                <span class="n">O_WRSW</span><span class="p">[</span><span class="n">i_dat</span><span class="p">]</span>       <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">nan</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">O_WRSW</span><span class="p">[</span><span class="n">i_dat</span><span class="p">]</span>       <span class="o">=</span> <span class="nf">int</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">20</span><span class="p">])</span>


            <span class="k">if</span> <span class="n">line</span><span class="p">[</span><span class="mi">21</span><span class="p">]</span><span class="o">==</span><span class="sh">'</span><span class="s">*****</span><span class="sh">'</span><span class="p">:</span>
                <span class="n">O_WRNW</span><span class="p">[</span><span class="n">i_dat</span><span class="p">]</span>       <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">nan</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">O_WRNW</span><span class="p">[</span><span class="n">i_dat</span><span class="p">]</span>       <span class="o">=</span> <span class="nf">int</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">21</span><span class="p">])</span>


            <span class="n">O_WRNEMODEL</span><span class="p">[</span><span class="n">i_dat</span><span class="p">]</span>  <span class="o">=</span> <span class="n">line</span><span class="p">[</span><span class="mi">22</span><span class="p">].</span><span class="nf">strip</span><span class="p">()</span>
            <span class="n">O_WRSEMODEL</span><span class="p">[</span><span class="n">i_dat</span><span class="p">]</span>  <span class="o">=</span> <span class="n">line</span><span class="p">[</span><span class="mi">23</span><span class="p">].</span><span class="nf">strip</span><span class="p">()</span>
            <span class="n">O_WRSWMODEL</span><span class="p">[</span><span class="n">i_dat</span><span class="p">]</span>  <span class="o">=</span> <span class="n">line</span><span class="p">[</span><span class="mi">24</span><span class="p">].</span><span class="nf">strip</span><span class="p">()</span>
            <span class="n">O_WRNWMODEL</span><span class="p">[</span><span class="n">i_dat</span><span class="p">]</span>  <span class="o">=</span> <span class="n">line</span><span class="p">[</span><span class="mi">25</span><span class="p">].</span><span class="nf">strip</span><span class="p">()</span>
            <span class="n">O_WRCONF</span><span class="p">[</span><span class="n">i_dat</span><span class="p">]</span>     <span class="o">=</span> <span class="nf">int</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">26</span><span class="p">])</span> <span class="nf">if </span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">26</span><span class="p">].</span><span class="nf">strip</span><span class="p">()</span> <span class="ow">or</span> <span class="bp">None</span><span class="p">)</span> <span class="k">else</span> <span class="n">np</span><span class="p">.</span><span class="n">nan</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># If there are no wind radii information then set to missing values
</span>            <span class="n">O_WRADII</span><span class="p">[</span><span class="n">i_dat</span><span class="p">]</span>     <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">nan</span>
            <span class="n">O_WRNE</span><span class="p">[</span><span class="n">i_dat</span><span class="p">]</span>       <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">nan</span>
            <span class="n">O_WRSE</span><span class="p">[</span><span class="n">i_dat</span><span class="p">]</span>       <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">nan</span>
            <span class="n">O_WRSW</span><span class="p">[</span><span class="n">i_dat</span><span class="p">]</span>       <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">nan</span>
            <span class="n">O_WRNW</span><span class="p">[</span><span class="n">i_dat</span><span class="p">]</span>       <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">nan</span>
            <span class="n">O_WRNEMODEL</span><span class="p">[</span><span class="n">i_dat</span><span class="p">]</span>  <span class="o">=</span> <span class="sh">'</span><span class="s"> </span><span class="sh">'</span>
            <span class="n">O_WRSEMODEL</span><span class="p">[</span><span class="n">i_dat</span><span class="p">]</span>  <span class="o">=</span> <span class="sh">'</span><span class="s"> </span><span class="sh">'</span>
            <span class="n">O_WRSWMODEL</span><span class="p">[</span><span class="n">i_dat</span><span class="p">]</span>  <span class="o">=</span> <span class="sh">'</span><span class="s"> </span><span class="sh">'</span>
            <span class="n">O_WRNWMODEL</span><span class="p">[</span><span class="n">i_dat</span><span class="p">]</span>  <span class="o">=</span> <span class="sh">'</span><span class="s"> </span><span class="sh">'</span>
            <span class="n">O_WRCONF</span><span class="p">[</span><span class="n">i_dat</span><span class="p">]</span>     <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">nan</span>
        


        <span class="n">O_RMW</span><span class="p">[</span><span class="n">i_dat</span><span class="p">]</span>  <span class="o">=</span> <span class="nf">int</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">27</span><span class="p">])</span> <span class="nf">if </span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">27</span><span class="p">].</span><span class="nf">strip</span><span class="p">()</span> <span class="ow">or</span> <span class="bp">None</span><span class="p">)</span> <span class="k">else</span> <span class="n">np</span><span class="p">.</span><span class="n">nan</span>
        <span class="n">O_RADEYE</span><span class="p">[</span><span class="n">i_dat</span><span class="p">]</span>  <span class="o">=</span> <span class="nf">int</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">28</span><span class="p">])</span> <span class="nf">if </span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">28</span><span class="p">].</span><span class="nf">strip</span><span class="p">()</span> <span class="ow">or</span> <span class="bp">None</span><span class="p">)</span> <span class="k">else</span> <span class="n">np</span><span class="p">.</span><span class="n">nan</span>

        <span class="c1"># Only for aircraft
</span>        <span class="k">if</span> <span class="sh">"</span><span class="s">AIRC</span><span class="sh">"</span> <span class="ow">in</span> <span class="n">line</span><span class="p">[</span><span class="mi">4</span><span class="p">].</span><span class="nf">strip</span><span class="p">():</span>
            <span class="n">A_RMW</span><span class="p">[</span><span class="n">i_dat</span><span class="p">]</span>  <span class="o">=</span> <span class="nf">int</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">37</span><span class="p">])</span> <span class="nf">if </span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">37</span><span class="p">].</span><span class="nf">strip</span><span class="p">()</span> <span class="ow">or</span> <span class="bp">None</span><span class="p">)</span> <span class="k">else</span> <span class="n">np</span><span class="p">.</span><span class="n">nan</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">A_RMW</span><span class="p">[</span><span class="n">i_dat</span><span class="p">]</span>  <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">nan</span>
        
    <span class="c1"># Check if we need to apply a fix constraint
</span>    <span class="c1"># If a contraint is applied then we also make sure that that constraint is not flagged as suspect
</span>    <span class="k">if</span> <span class="n">FIXTYPE</span><span class="o">!=</span><span class="sh">''</span><span class="p">:</span>
        <span class="n">cond_fx</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="nf">for </span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span> <span class="ow">in</span> <span class="nf">zip</span><span class="p">(</span><span class="nf">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nf">len</span><span class="p">(</span><span class="n">O_CENTERI</span><span class="p">)),</span><span class="n">O_CENTERI</span><span class="p">,</span><span class="n">O_FLAGIND</span><span class="p">)</span> <span class="nf">if </span><span class="p">(((</span><span class="n">FIXTYPE</span> <span class="ow">or</span> <span class="sh">'</span><span class="s">F</span><span class="sh">'</span><span class="p">)</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">y</span><span class="p">))</span>  <span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">cond_fx</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nf">len</span><span class="p">(</span><span class="n">O_CENTERI</span><span class="p">))]</span>
        

    <span class="k">return</span> <span class="n">O_DATE</span><span class="p">[</span><span class="n">cond_fx</span><span class="p">],</span> <span class="n">O_STID</span><span class="p">[</span><span class="n">cond_fx</span><span class="p">],</span> <span class="n">O_FXFORMAT</span><span class="p">[</span><span class="n">cond_fx</span><span class="p">],</span> <span class="n">O_FIXTTYPE</span><span class="p">[</span><span class="n">cond_fx</span><span class="p">],</span> <span class="n">O_CENTERI</span><span class="p">[</span><span class="n">cond_fx</span><span class="p">],</span> <span class="n">O_FLAGIND</span><span class="p">[</span><span class="n">cond_fx</span><span class="p">],</span> <span class="n">O_FLAT</span><span class="p">[</span><span class="n">cond_fx</span><span class="p">],</span> <span class="n">O_FLON</span><span class="p">[</span><span class="n">cond_fx</span><span class="p">],</span> <span class="n">O_HEIGHT</span><span class="p">[</span><span class="n">cond_fx</span><span class="p">],</span> <span class="n">O_POSITCONF</span><span class="p">[</span><span class="n">cond_fx</span><span class="p">],</span> \
        <span class="n">O_VMAX</span><span class="p">[</span><span class="n">cond_fx</span><span class="p">],</span> <span class="n">O_VMAXCONF</span><span class="p">[</span><span class="n">cond_fx</span><span class="p">],</span> <span class="n">O_MSLP</span><span class="p">[</span><span class="n">cond_fx</span><span class="p">],</span> <span class="n">O_MSLPCONF</span><span class="p">[</span><span class="n">cond_fx</span><span class="p">],</span> <span class="n">O_MSLPDERIV</span><span class="p">[</span><span class="n">cond_fx</span><span class="p">],</span> <span class="n">O_WRADII</span><span class="p">[</span><span class="n">cond_fx</span><span class="p">],</span> <span class="n">O_WRNE</span><span class="p">[</span><span class="n">cond_fx</span><span class="p">],</span> <span class="n">O_WRSE</span><span class="p">[</span><span class="n">cond_fx</span><span class="p">],</span> <span class="n">O_WRSW</span><span class="p">[</span><span class="n">cond_fx</span><span class="p">],</span> <span class="n">O_WRNW</span><span class="p">[</span><span class="n">cond_fx</span><span class="p">],</span> <span class="n">O_WRNEMODEL</span><span class="p">[</span><span class="n">cond_fx</span><span class="p">],</span>\
        <span class="n">O_WRSEMODEL</span><span class="p">[</span><span class="n">cond_fx</span><span class="p">],</span> <span class="n">O_WRSWMODEL</span><span class="p">[</span><span class="n">cond_fx</span><span class="p">],</span> <span class="n">O_WRNWMODEL</span><span class="p">[</span><span class="n">cond_fx</span><span class="p">],</span> <span class="n">O_WRCONF</span><span class="p">[</span><span class="n">cond_fx</span><span class="p">],</span> <span class="n">O_RMW</span><span class="p">[</span><span class="n">cond_fx</span><span class="p">],</span> <span class="n">O_RADEYE</span><span class="p">[</span><span class="n">cond_fx</span><span class="p">],</span><span class="n">A_RMW</span><span class="p">[</span><span class="n">cond_fx</span><span class="p">]</span>



<span class="k">if</span> <span class="n">__name__</span><span class="o">==</span><span class="sh">'</span><span class="s">__main__</span><span class="sh">'</span><span class="p">:</span>

    <span class="n">PATH_TO_FDECK_FILES</span> <span class="o">=</span> <span class="sh">'</span><span class="s">FIX/f*.dat</span><span class="sh">'</span>

    <span class="c1"># Read in the data from the function specifyin the path and the observation type, here we want SAR
</span>    <span class="n">DATE</span><span class="p">,</span> <span class="n">STID</span><span class="p">,</span> <span class="n">FXFORMAT</span><span class="p">,</span> <span class="n">FIXTTYPE</span><span class="p">,</span> <span class="n">CENTERI</span><span class="p">,</span> <span class="n">FLAGIND</span><span class="p">,</span> <span class="n">FLAT</span><span class="p">,</span> <span class="n">FLON</span><span class="p">,</span> <span class="n">HEIGHT</span><span class="p">,</span> <span class="n">POSITCONF</span><span class="p">,</span> <span class="n">VMAX</span><span class="p">,</span> <span class="n">VMAXCONF</span><span class="p">,</span> <span class="n">MSLP</span><span class="p">,</span> \
     <span class="n">MSLPCONF</span><span class="p">,</span> <span class="n">MSLPDERIV</span><span class="p">,</span> <span class="n">WRADII</span><span class="p">,</span> <span class="n">WRNE</span><span class="p">,</span> <span class="n">WRSE</span><span class="p">,</span> <span class="n">WRSW</span><span class="p">,</span> <span class="n">WRNW</span><span class="p">,</span> <span class="n">WRNEMODEL</span><span class="p">,</span><span class="n">WRSEMODEL</span><span class="p">,</span> <span class="n">WRSWMODEL</span><span class="p">,</span> <span class="n">WRNWMODEL</span><span class="p">,</span> <span class="n">WRCONF</span><span class="p">,</span> \
     <span class="n">RMW</span><span class="p">,</span> <span class="n">RADEYE</span><span class="p">,</span> <span class="n">ARMW</span> <span class="o">=</span> <span class="nf">get_fdeck_grep</span><span class="p">(</span><span class="sh">'"</span><span class="s">SAR</span><span class="sh">"'</span> <span class="p">,</span><span class="n">PATH_TO_FDECK_FILES</span><span class="p">)</span>
    
    <span class="c1">#--------------------------------------------------------------
</span>    <span class="c1"># Plot RMW v. Latitude
</span>    <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="p">.</span><span class="nf">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="p">.</span><span class="nf">subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>

    <span class="n">cmap1</span> <span class="o">=</span> <span class="n">copy</span><span class="p">.</span><span class="nf">copy</span><span class="p">(</span><span class="n">plt</span><span class="p">.</span><span class="n">cm</span><span class="p">.</span><span class="n">rainbow</span><span class="p">)</span>

    <span class="n">XVAR</span> <span class="o">=</span> <span class="n">RMW</span><span class="p">[</span><span class="n">WRADII</span><span class="o">==</span><span class="mi">34</span><span class="p">]</span>  <span class="c1"># Don't include duplicates from R50 and R64
</span>    <span class="n">YVAR</span> <span class="o">=</span> <span class="n">FLAT</span><span class="p">[</span><span class="n">WRADII</span><span class="o">==</span><span class="mi">34</span><span class="p">]</span> <span class="c1"># Don't include duplicates from R50 and R64
</span>
    <span class="n">im</span> <span class="o">=</span> <span class="n">ax</span><span class="p">.</span><span class="nf">hexbin</span><span class="p">(</span><span class="n">XVAR</span><span class="p">,</span><span class="n">YVAR</span><span class="p">,</span><span class="n">gridsize</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="p">.</span><span class="mi">9</span><span class="p">,</span><span class="n">linewidths</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">vmin</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">cmap</span><span class="o">=</span><span class="n">cmap1</span><span class="p">)</span>
    <span class="n">im</span><span class="p">.</span><span class="n">cmap</span><span class="p">.</span><span class="nf">set_under</span><span class="p">(</span><span class="sh">'</span><span class="s">w</span><span class="sh">'</span><span class="p">)</span>

    <span class="n">ax</span><span class="p">.</span><span class="nf">scatter</span><span class="p">(</span><span class="n">XVAR</span><span class="p">,</span><span class="n">YVAR</span><span class="p">,</span><span class="n">c</span><span class="o">=</span><span class="sh">'</span><span class="s">k</span><span class="sh">'</span><span class="p">,</span><span class="n">s</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

    <span class="c1"># Limit the boundaries
</span>    <span class="n">ax</span><span class="p">.</span><span class="nf">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">225</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">.</span><span class="nf">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">55</span><span class="p">,</span><span class="mi">55</span><span class="p">)</span>

    <span class="c1"># Add labels
</span>    <span class="n">ax</span><span class="p">.</span><span class="nf">set_title</span><span class="p">(</span><span class="sh">'</span><span class="s">SAR Observations (2016-2023)</span><span class="sh">'</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">.</span><span class="nf">set_xlabel</span><span class="p">(</span><span class="sh">'</span><span class="s">RMW (n mi)</span><span class="sh">'</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">.</span><span class="nf">set_ylabel</span><span class="p">(</span><span class="sh">'</span><span class="s">Latitude (degrees)</span><span class="sh">'</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>

    <span class="c1"># Increase size of xticks
</span>    <span class="n">ax</span><span class="p">.</span><span class="nf">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="sh">'</span><span class="s">y</span><span class="sh">'</span><span class="p">,</span><span class="n">labelsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">.</span><span class="nf">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="sh">'</span><span class="s">x</span><span class="sh">'</span><span class="p">,</span><span class="n">labelsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
    
    <span class="c1"># Remove the top and right lines
</span>    <span class="n">ax</span><span class="p">.</span><span class="n">spines</span><span class="p">[</span><span class="sh">"</span><span class="s">top</span><span class="sh">"</span><span class="p">].</span><span class="nf">set_visible</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">.</span><span class="n">spines</span><span class="p">[</span><span class="sh">"</span><span class="s">right</span><span class="sh">"</span><span class="p">].</span><span class="nf">set_visible</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
    
    <span class="n">cb</span> <span class="o">=</span> <span class="n">plt</span><span class="p">.</span><span class="nf">colorbar</span><span class="p">(</span><span class="n">im</span><span class="p">,</span><span class="n">pad</span><span class="o">=</span><span class="p">.</span><span class="mi">02</span><span class="p">,</span><span class="n">shrink</span><span class="o">=</span><span class="p">.</span><span class="mi">7</span><span class="p">)</span>
    

    <span class="n">plt</span><span class="p">.</span><span class="nf">savefig</span><span class="p">(</span><span class="sh">'</span><span class="s">SAR_RMWvLat_Allbasins.png</span><span class="sh">'</span><span class="p">,</span><span class="n">bbox_inches</span><span class="o">=</span><span class="sh">'</span><span class="s">tight</span><span class="sh">'</span><span class="p">)</span>
    <span class="n">plt</span><span class="p">.</span><span class="nf">show</span><span class="p">()</span>



</code></pre></div></div> <hr> <p>The code above reads in the fix dataset and can be used to plot SAR data. To illustrate, we can plot the distribution of RMW vs. latitude.</p> <div class="row"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/TrabingWx/assets/img/SAR_RMWvLat_Allbasins-480.webp"></source> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/TrabingWx/assets/img/SAR_RMWvLat_Allbasins-800.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/TrabingWx/assets/img/SAR_RMWvLat_Allbasins-1400.webp"></source> <img src="/TrabingWx/assets/img/SAR_RMWvLat_Allbasins.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" title="SAR_RMWvLat" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> A figure showing latitude vs. RMW for all SAR fixes. </div> </div> </article> <br> <hr> <br> <ul class="list-disc pl-8"></ul> <h2 class="text-3xl font-semibold mb-4 mt-12">Enjoy Reading This Article?</h2> <p class="mb-2">Here are some more articles you might like to read next:</p> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/TrabingWx/blog/2021/plot-discont/">Plotting Discontinuous Data</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/TrabingWx/blog/2023/end-2023/">End of the 2023 Atlantic Hurricane Season</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/TrabingWx/blog/2023/enso-2023/">El Niño and Hurricanes</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/TrabingWx/blog/2018/contour/">Plotting with Python</a> </li> </div> </div> <footer class="fixed-bottom"> <div class="container mt-0"> © Copyright 2023 Benjamin Trabing. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>. Last updated: December 18, 2023. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/TrabingWx/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@4/imagesloaded.pkgd.min.js"></script> <script defer src="/TrabingWx/assets/js/masonry.js" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.8/dist/medium-zoom.min.js" integrity="sha256-7PhEpEWEW0XXQ0k6kQrPKwuoIomz8R8IYyuU1Qew4P8=" crossorigin="anonymous"></script> <script defer src="/TrabingWx/assets/js/zoom.js?7b30caa5023af4af8408a472dc4e1ebb"></script> <script defer src="https://unpkg.com/bootstrap-table@1.22.1/dist/bootstrap-table.min.js"></script> <script src="/TrabingWx/assets/js/no_defer.js?d633890033921b33e0ceb13d22340a9c"></script> <script defer src="/TrabingWx/assets/js/common.js?acdb9690d7641b2f8d40529018c71a01"></script> <script defer src="/TrabingWx/assets/js/copy_code.js?c9d9dd48933de3831b3ee5ec9c209cac" type="text/javascript"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script> <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script type="text/javascript">function progressBarSetup(){"max"in document.createElement("progress")?(initializeProgressElement(),$(document).on("scroll",function(){progressBar.attr({value:getCurrentScrollPosition()})}),$(window).on("resize",initializeProgressElement)):(resizeProgressBar(),$(document).on("scroll",resizeProgressBar),$(window).on("resize",resizeProgressBar))}function getCurrentScrollPosition(){return $(window).scrollTop()}function initializeProgressElement(){let e=$("#navbar").outerHeight(!0);$("body").css({"padding-top":e}),$("progress-container").css({"padding-top":e}),progressBar.css({top:e}),progressBar.attr({max:getDistanceToScroll(),value:getCurrentScrollPosition()})}function getDistanceToScroll(){return $(document).height()-$(window).height()}function resizeProgressBar(){progressBar.css({width:getWidthPercentage()+"%"})}function getWidthPercentage(){return getCurrentScrollPosition()/getDistanceToScroll()*100}const progressBar=$("#progress");window.onload=function(){setTimeout(progressBarSetup,50)};</script> <a title="Web Analytics" href="https://clicky.com/101437508" rel="external nofollow noopener" target="_blank"><img alt="Clicky" src="//static.getclicky.com/media/links/badge.gif" border="0"></a> <script async data-id="101437508" src="//static.getclicky.com/js"></script> </body> </html>